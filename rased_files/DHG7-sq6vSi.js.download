if (self.CavalryLogger) { CavalryLogger.start_js(["QZIRZ"]); }

__d("ScheduledLiveTimeStringUtil",["fbt","DateStrings","React","formatDate"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=24*60*60*1e3;a={getStr:function(a,c){return c?b("React").jsx("span",{children:this.getUppercaseDateStr(a)}):b("React").jsxs("span",{children:[this.getDateStr(a)," ",g._("{date}",[g._param("date",b("formatDate")(a,"g:ia"))])]})},getDateStr:function(a){var c=new Date(Date.now()),d=new Date(Date.now()+h),e=new Date(Date.now()+2*h),f=new Date(Date.now()+3*h),i=a.toDateString();c.toDateString()===i?c=g._("Today at"):d.toDateString()===i?c=g._("Tomorrow at"):e.toDateString()===i||f.toDateString()===i?c=this._renderDayOfWeekString(a.getDay()):c=b("formatDate")(a,"F d");return c},getUppercaseDateStr:function(a){var c=new Date(Date.now()),d=new Date(Date.now()+h),e=new Date(Date.now()+2*h),f=new Date(Date.now()+3*h),i=a.toDateString(),j=b("formatDate")(a,"g:iA");c.toDateString()===i?c=g._("TODAY AT {time of day}",[g._param("time of day",j)]):d.toDateString()===i?c=g._("TOMORROW AT {time of day}",[g._param("time of day",j)]):e.toDateString()===i||f.toDateString()===i?c=this._renderUppercaseDayOfWeekString(a.getDay(),a):c=g._("{day of month} AT {time of day}",[g._param("day of month",b("formatDate")(a,"F d")),g._param("time of day",j)]);return c},_renderUppercaseDayOfWeekString:function(a,c){if(a>=0&&a<=6){c=b("formatDate")(c,"g:iA");return g._("{day of week} AT {time of day}",[g._param("day of week",b("DateStrings").getUppercaseWeekdayName(a)),g._param("time of day",c)])}return null},_renderDayOfWeekString:function(a){switch(a){case 0:return g._("Sunday at");case 1:return g._("Monday at");case 2:return g._("Tuesday at");case 3:return g._("Wednesday at");case 4:return g._("Thursday at");case 5:return g._("Friday at");case 6:return g._("Saturday at")}return null}};e.exports=a}),null);
__d("ScheduledLiveStoryVideoPreviewFooter.react",["ix","cx","fbt","Image.react","React","ScheduledLiveTimeStringUtil","XUIButton.react","XUICardSection.react","XUIText.react","asset"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();function a(a){var c=a.isPremiere&&a.plannedStartTime===0;c=c?i._("Starting soon"):b("ScheduledLiveTimeStringUtil").getStr(new Date(a.plannedStartTime),!0);var d=a.isPremiere?g("591214"):g("595518");d=b("React").jsx("div",{className:"_6lz _6mb _1t62",children:b("React").jsxs(b("XUIText.react"),{className:"_6d27",children:[b("React").jsx(b("Image.react"),{src:d,className:"_6cfz"}),c]})});c=b("React").jsx("div",{className:"_6m6 _2cnj _fwx _6etm",children:b("React").jsx(b("XUIText.react"),{size:"body1",children:a.previewTitle})});a=b("React").jsx(b("XUIText.react"),{color:"secondary",className:"_20l4 _svw",children:i._("Tune in to watch live")});var e=b("React").jsx("div",{className:"_44af _2e6-",children:b("React").jsx(b("XUIButton.react"),{size:"medium",label:i._("Get Reminder"),image:b("React").jsx(b("Image.react"),{src:g("492370")})})});return b("React").jsx(b("XUICardSection.react"),{className:"_64lx _3eqz _pmm _267a _66cd _6d28 _2v9b",children:b("React").jsxs("div",{className:"_44ae _651x",children:[b("React").jsxs("div",{className:"_59tj _2iau _oq1 _6m3 _--6 _4dhn",children:[d,c,a]}),e]})})}e.exports=a}),null);
__d("ScheduledLiveStoryVideoPreviewV2.react",["cx","BackgroundImage.react","Image.react","React","ScaledImage.react","ScheduledLiveStoryVideoPreviewFooter.react","XUICardSection.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=a.URL||a.webkitURL||{};c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").jsx("div",{children:this.$1()})};d.$2=function(){return this.props.backgroundImage.imageURL&&this.props.backgroundImage.width&&this.props.backgroundImage.height?this.props.customProfileImage?this.$3():b("React").jsx(b("ScaledImage.react"),{width:500,height:280,src:this.props.backgroundImage.imageURL,imageSize:{width:this.props.backgroundImage.width,height:this.props.backgroundImage.height}}):null};d.$3=function(){var a=this.props.customProfileImage,c=this.props.customProfileImagePosition;c=c?c.x*100+"% "+c.y*100+"%":"50% 50%";if(a!=null)return b("React").jsx(b("BackgroundImage.react"),{backgroundSize:"coverinside",backgroundPosition:c,height:280,src:h.createObjectURL(a),width:500});return this.props.previousCustomImage!=null?b("React").jsx(b("Image.react"),{className:"_as4",src:this.props.previousCustomImage}):b("React").jsx(b("Image.react"),{className:"_as4",src:this.props.profileImageURL})};d.$1=function(){return b("React").jsxs("div",{children:[b("React").jsx(b("XUICardSection.react"),{className:"_6dw8",children:this.$2()}),b("React").jsx(b("ScheduledLiveStoryVideoPreviewFooter.react"),{isPremiere:this.props.isPremiere===!0,plannedStartTime:this.props.plannedStartTime,previewTitle:this.props.previewTitle})]})};return c}(b("React").Component);e.exports=c}),null);
__d("StoryProfile.react",["cx","BackgroundImage.react","FBProfilePhotoShadow.react","Image.react","ImageBlock.react","InlineBlock.react","Link.react","PrivacyConst","React","XUIGrayText.react","XUIText.react","joinClasses","prop-types"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$1=function(){var a=null;if(d.props.privacyIndicator)a=d.props.privacyIndicator;else if(d.props.privacySetting){var c=d.props.privacySetting==b("PrivacyConst").BaseValue.EVERYONE,e=d.props.privacySetting==b("PrivacyConst").BaseValue.ALL_FRIENDS;a=b("React").jsx(b("BackgroundImage.react"),{width:13,height:12,"data-hover":"tooltip","data-tooltip-content":d.props.privacyTooltip,className:"_14g-"+(c?" _14g_":"")+(e?" _5qhp":"")+(!e&&!c?" _14h0":"")})}return!a?null:b("React").jsxs("span",{children:[b("React").jsx(b("XUIGrayText.react"),{shade:"light",size:"meta1",display:"inline",children:"\xa0\xb7\xa0"}),a]})},d.$2=function(){__p&&__p();var a,c;if(d.props.profileURL){var e;d.props.openProfileURLInNewPage&&(e="_blank");c="bold";a=b("React").jsx(b("Link.react"),{href:d.props.profileURL,target:e,children:d.props.username})}else a=d.props.username;if(d.props.description)return b("React").jsxs("div",{children:[b("React").jsx(b("XUIText.react"),{className:"_14gz",size:"header4",weight:c,children:a})," ",d.props.description]});else return b("React").jsx(b("XUIText.react"),{className:"_14gz",size:"header4",weight:c,display:"block",children:a})},d.$3=function(){return d.props.additionalLinks?b("React").jsx(b("XUIGrayText.react"),{shade:"light",size:"meta1",display:"inline",children:d.props.additionalLinks.map(function(a,c){return b("React").jsxs("span",{children:["\xa0\xb7\xa0",b("React").jsx(b("Link.react"),{href:a.URL,target:"_blank",children:a.text})]},c)})}):null},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.render=function(){return b("React").jsxs(b("ImageBlock.react"),{spacing:"medium",className:b("joinClasses")(this.props.className,"_56-3"),children:[this.props.profilePicture?b("React").jsx(b("FBProfilePhotoShadow.react"),{children:b("React").jsx(b("Image.react"),{className:"_56-4"+(this.props.useRoundPicture?" _6y18":""),src:this.props.profilePicture})}):b("React").jsx("span",{}),b("React").jsxs(b("InlineBlock.react"),{alignv:"middle",height:40,fullWidth:!0,children:[this.$2(),b("React").jsxs("div",{children:[b("React").jsx(b("XUIGrayText.react"),{shade:"light",size:"meta1",display:"inline",children:this.props.uploadTime}),this.$1(),this.$3()]})]})]})};return c}(b("React").Component);a.propTypes={privacySetting:(c=b("prop-types")).number,privacyIndicator:c.object,profilePicture:c.string,privacyTooltip:c.node,username:c.string.isRequired,uploadTime:c.node.isRequired,profileURL:c.string,openProfileURLInNewPage:c.bool,additionalLinks:c.arrayOf(c.shape({URL:c.string,text:c.node})),description:c.node};a.defaultProps={openProfileURLInNewPage:!1};e.exports=a}),null);
__d("XLiveScheduleStoryPreviewController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live/schedule/preview/",{target_id:{type:"FBID"},broadcast_id:{type:"FBID"}})}),null);
__d("ScheduledLiveStoryPreview.react",["cx","fbt","ActorURI","AsyncRequest","React","ScheduledLiveStoryVideoPreviewV2.react","StoryProfile.react","XLiveScheduleStoryPreviewController","XUICard.react","XUICardSection.react","XUIText.react","cxMargin"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i="/images/silhouettes/person_50x50.png";a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b){var c;c=a.call(this,b)||this;c.$2=function(a){a=a.getPayload();c.setState({plannedStartTime:a.plannedStartTime,profileName:a.profileName,profileImageURL:a.profileImageURL,profileURL:a.profileURL,backgroundImage:a.backgroundImage,previousCustomImage:a.previousCustomImage})};c.state={profileName:"",profileImageURL:i,profileURL:"",backgroundImage:{},previousCustomImage:null,plannedStartTime:null};return c}var d=c.prototype;d.componentDidMount=function(){this.$1(this.props)};d.componentDidUpdate=function(a,b){(a.actorID!==this.props.actorID||a.targetID!==this.props.targetID)&&this.$1(this.props)};d.$1=function(a){var c=b("XLiveScheduleStoryPreviewController").getURIBuilder().setFBID("target_id",a.targetID).setFBID("broadcast_id",a.broadcastID).getURI();c=b("ActorURI").create(c,(c=a.actorID)!=null?c:a.targetID);new(b("AsyncRequest"))().setURI(c).setMethod("POST").setHandler(this.$2).send()};d.render=function(){var a;return b("React").jsxs(b("XUICard.react"),{children:[b("React").jsxs(b("XUICardSection.react"),{children:[this.$3(),this.$4()]}),b("React").jsx(b("ScheduledLiveStoryVideoPreviewV2.react"),{backgroundImage:this.state.backgroundImage,customProfileImage:this.props.customProfileImage,customProfileImagePosition:this.props.customProfileImagePosition,isPremiere:this.props.isPremiere,plannedStartTime:(a=this.state.plannedStartTime)!=null?a:this.props.plannedStartTime,previousCustomImage:this.state.previousCustomImage,profileImageURL:this.state.profileImageURL,profileName:this.state.profileName,previewTitle:this.props.previewTitle})]})};d.$3=function(){var a=h._("plans to go live.");this.props.isPremiere&&(a=this.props.plannedStartTime?h._("plans to premiere a video."):h._("plans to release a new video."));return b("React").jsx("div",{className:"_3-8j",children:b("React").jsx(b("StoryProfile.react"),{openProfileURLInNewPage:!0,profilePicture:this.state.profileImageURL,profileURL:this.state.profileURL,useRoundPicture:!0,username:this.state.profileName,uploadTime:h._("Just Now"),description:a})})};d.$4=function(){return b("React").jsx(b("XUIText.react"),{className:"_as3",display:"block",size:"header4",children:this.props.description})};return c}(b("React").Component);e.exports=a}),null);
__d("LivingRoomConstants",[],(function(a,b,c,d,e,f){a={END_SCREEN_CHAINING_TIMEOUT_SECONDS:5,FEED_BLUR_OVERLAY_DELAY_MS:7500,GROUP_MALL_CARD_BANNER:{uri:"/images/live_video/godzilla_nux/living_room_godzilla_nux.png",width:680,height:380},INVITE_FRIENDS_RESULTS_PER_PAGE:20,INVITE_FRIENDS_RESULTS_PER_EXTRA_PAGE:10,NO_VIDEO_RECAP_THUMBNAIL:{uri:"/images/live_video/living_room/no_video_thumbnail.png",width:375,height:250},NUX_CREATE_WITH_CUSTOM_NAME:6218,NUX_FEED_PRESENCE:6358,NUX_HOST_WELCOME:5612,NUX_HOST_WALKTHROUGH:5634,NUX_PRE_POP:5972,NUX_PRESENCE_TRAY:5584,NUX_VIEWER_WELCOME:5594,NUX_PAGE_VIDEO_LIBRARY_BUTTON:6488,TOPIC_CHANNEL_NUX_VIEWER_WELCOME:5814,TOPIC_CHANNEL_NUX_PRESENCE_TRAY:5815,PARTICIPANTS_PAGE_SIZE:20,RECAP_LOAD_SIZE:10,RECAP_REFETCH_PADDING:5,TV_EMOJI:"1f4fa",UPDATE_SUGGESTED_ITEMS:"update_suggested_items",UPDATE_VIDEO_STATE:"update_video_state",VIEWER_REACTION:"viewer_reaction",VIDEO_START_SECONDS:1e-5,VIDEO_SEARCH_DEBOUNCING_DELAY:750,VIDEO_SEARCH_BQF:"keywords_blended_videos",VIDEO_SEARCH_PAGE_BQF:"videos-by",VIDEO_SEARCH_RESULTS_PER_PAGE:20,VIDEO_SEARCH_RESULTS_PER_EXTRA_PAGE:10,SIDE_PANE_WIDTH:400,MIN_MEDIA_CONTAINER_WIDTH:476,MIN_MEDIA_CONTAINER_HEIGHT:560};e.exports=a}),null);
__d("LivingRoomCreationSource",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CHANNEL_FEED_CTA:"channel_feed_cta",EDIT:"edit",END_SCREEN_CTA:"end_screen_cta",ENDED_LIVING_ROOM_STORY_CTA:"ended_living_room_story_cta",EVERGREEN_QP:"evergreen_qp",FEED_CTA_ON_ALWAYS_SHOW:"feed_cta_on_always_show",FEED_CTA_ON_COMMENT:"feed_cta_on_comment",FEED_CTA_ON_NEWSFEED:"feed_cta_on_newsfeed",FEED_CTA_ON_REACT:"feed_cta_on_react",FEED_CTA_ON_SAVE:"feed_cta_on_save",FEED_CTA_ON_SHARE:"feed_cta_on_share",FEED_CTA_ON_UNKNOWN:"feed_cta_on_unknown",FEED_CTA_ON_VIDEO_PRESS:"feed_cta_on_video_press",FUNDRAISER_COMPOSER:"fundraiser_composer",GAMES_VIDEO_RERUN_MANAGER:"games_video_rerun_manager",GOODWILL_THROWBACK_CTA:"goodwill_throwback_cta",GROUP_ACTIVE_LIVING_ROOMS_CTA:"group_active_living_rooms_cta",GROUP_ACTIVE_LIVING_ROOMS_FEED_CTA:"group_active_living_rooms_feed_cta",GROUP_ACTIVE_LIVING_ROOMS_NULL_STATE_CTA:"group_active_living_rooms_null_state_cta",GROUP_COMPOSER:"group_composer",GROUP_FEED_QP:"group_feed_qp",GROUP_MALL_CARD:"group_mall_card",GROUP_MALL_VIDEO_CTA:"group_mall_video_cta",GROUP_PILL_COMPOSER:"group_pill_composer",HOUSE_AD:"house_ad",LIVE_VIDEO_CTA:"live_video_cta",LIVE_VIDEO_CUE:"live_video_cue",LIVE_VIDEO_GODZILLA_NUX:"live_video_godzilla_nux",LIVE_VIDEO_GODZILLA_NUX_SHARESHEET:"live_video_godzilla_nux_sharesheet",LIVE_VIDEO_PROMPT:"live_video_prompt",LIVE_VIDEO_SHARE_SHEET:"live_video_share_sheet",LIVING_ROOM_DASHBOARD_CONNECTED:"living_room_dashboard_connected",LIVING_ROOM_DASHBOARD_PERSONAL:"living_room_dashboard_personal",LIVING_ROOM_ENDSCREEN_CTA:"living_room_endscreen_cta",LIVING_ROOM_SHARE_SHEET:"living_room_share_sheet",LIVING_ROOM_SYSTEM_MESSAGE:"living_room_system_message",LIVING_ROOM_VIDEO_CONTROL_CTA:"living_room_video_control_cta",MESSENGER:"messenger",MESSENGER_COMPOSER:"messenger_composer",MESSENGER_CTA:"messenger_cta",MESSENGER_RTC_CALL:"messenger_rtc_call",MESSENGER_SOLO_PLAYER:"messenger_solo_player",MESSENGER_SOLO_PLAYER_FULL_SCREEN:"messenger_solo_player_full_screen",MESSENGER_VIDEO_ATTACHMENT:"messenger_video_attachment",NEWSFEED_COMPOSER:"newsfeed_composer",NOTIFICATION:"notification",NT_CVC_BOTTOMSHEET:"nt_cvc_bottomsheet",NT_WATCH_TAB_CTA:"nt_watch_tab_cta",NT_WATCHING_TOGETHER:"nt_watching_together",NT_WATCHING_TOGETHER_CTA:"nt_watching_together_cta",NT_WATCHING_TOGETHER_GROUPS_TAB:"nt_watching_together_groups_tab",PAGE_ADMIN_QP:"page_admin_qp",PAGE_COMPOSER:"page_composer",PAGE_COMPOSER_DIALOG:"page_composer_dialog",PAGE_COMPOSER_PREMIERE:"page_composer_premiere",PAGE_FEED_OPTION:"page_feed_option",PAGE_TIMELINE_VIDEO_CTA:"page_timeline_video_cta",PAGE_VIDEO_LIBRARY_BUTTON:"page_video_library_button",PAGE_VIDEO_LIBRARY_MEGAPHONE:"page_video_library_megaphone",PMV_QP:"pmv_qp",PORTAL_FACEBOOK_WATCH_TV_APP:"portal_facebook_watch_tv_app",RECOMMENDED_SHARE_IN_LIVE:"recommended_share_in_live",REPLAY_FEED_CTA:"replay_feed_cta",REPLAY_INTERACTIVE_ALERT:"replay_interactive_alert",REPLAY_UFI_SHARE:"replay_ufi_share",SAVED_BOOKMARK_CHEVRON:"saved_bookmark_chevron",SOTTO_CATALOG_WATCH_TOGETHER:"sotto_catalog_watch_together",TEST:"test",UFI_SHARE:"ufi_share",UNKNOWN:"unknown",UNKNOWN_COMPOSER:"unknown_composer",UNKNOWN_TIMELINE_VIDEO_CTA:"unknown_timeline_video_cta",USER_TIMELINE_COMPOSER:"user_timeline_composer",USER_TIMELINE_VIDEO_CTA:"user_timeline_video_cta",VIDEO_INSIGHTS_DIALOG:"video_insights_dialog",VIDEO_PLAYER_PLUGIN:"video_player_plugin",VIDEO_PLAYER_PLUGIN_DIALOG:"video_player_plugin_dialog",WARION_CUE_CTA:"warion_cue_cta"})}),null);
__d("LivingRoomCountdown.react",["fbt","invariant","FluxContainer","LivingRoomStore","React","clearInterval","setInterval"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=function(a,c){a=b("LivingRoomStore").getCountdown(a);if(!a)return null;return a.type===c?a.seconds_remaining:null};a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$1=null,c.state={secondsRemaining:i(c.props.livingRoomID,c.props.countdownType)},b)||babelHelpers.assertThisInitialized(c)}c.getStores=function(){return[b("LivingRoomStore")]};c.calculateState=function(a,c){b("LivingRoomStore")!==null||h(0,12747);return{secondsRemaining:i(c.livingRoomID,c.countdownType)}};var d=c.prototype;d.componentDidMount=function(){var a=this;this.$1=b("setInterval")(function(){return a.setState(function(a){return{secondsRemaining:a.secondsRemaining==null?null:Math.max(a.secondsRemaining-1,0)}})},1e3)};d.componentWillUnmount=function(){this.$1&&b("clearInterval")(this.$1)};d.$2=function(a){var b=a%60;a=Math.floor(a/60);var c=a%60;a=Math.floor(a/60);b=("0"+b).slice(-2);c=("0"+c).slice(-2);return a===0?[c,b].join(":"):[a<10?"0"+a:String(a),c,b].join(":")};d.render=function(){return this.state.secondsRemaining==null?null:g._("Starting in {timer count down}",[g._param("timer count down",this.$2(this.state.secondsRemaining))])};return c}(b("React").Component);e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("LivingRoomFeedAttachmentBadgeRow.react",["ix","cx","fbt","Image.react","LivingRoomCountdown.react","React","asset","nullthrows"],(function(a,b,c,d,e,f,g,h,i){function a(a){return b("React").jsxs("div",{className:(a.premiereLivingRoomBadgeText==null&&!a.isReplay?"_6rb7":"")+(a.premiereLivingRoomBadgeText?" _731g":"")+(a.isReplay?" _7rp9":""),children:[b("React").jsx(b("Image.react"),{className:"_6rb8 _6ziq",src:a.premiereLivingRoomBadgeText==null?g("487848"):g("591215")}),b("React").jsx("span",{className:"_6rb8",children:a.premiereLivingRoomBadgeText==null?i._("WATCH PARTY"):a.premiereLivingRoomBadgeText}),a.premiereLivingRoomBadgeText!=null&&a.presentUserCount!=null&&b("React").jsx("span",{className:"_6rb8 _73qf",children:i._({"*":"{number} Watching Now","_1":"1 Watching Now"},[i._plural(a.presentUserCount,"number")])}),a.showTimerForCountdownType!=null&&a.livingRoomID!==null&&b("React").jsx("span",{className:"_6rb8 _73qf",children:b("React").jsx(b("LivingRoomCountdown.react"),{countdownType:a.showTimerForCountdownType,livingRoomID:b("nullthrows")(a.livingRoomID)})})]})}e.exports=a}),null);
__d("LivingRoomFeedAttachmentFooterNoContentItem.react",["cx","fbt","React"],(function(a,b,c,d,e,f,g,h){function a(){return b("React").jsxs("div",{children:[b("React").jsx("div",{className:"_2luh",children:h._("No Video")}),b("React").jsx("div",{className:"_2lu8",children:h._("Join to suggest a video")})]})}e.exports=a}),null);
__d("LivingRoomNoVideoPreview.react",["cx","ix","Image.react","React"],(function(a,b,c,d,e,f,g,h){function a(a){return b("React").jsx("div",{className:"_3hj7",children:b("React").jsx(b("Image.react"),{className:"_7m-7",src:h("646608")})})}e.exports=a}),null);
__d("CommercialBreakHostStoryComponentType",[],(function(a,b,c,d,e,f){a=Object.freeze({POP_OVER_MENU:"POP_OVER_MENU",HOST_STORY_HEADER:"HOST_STORY_HEADER"});e.exports=a}),null);
__d("StoryComponentVideoPlayerControllerRegistry",["CommercialBreakHostStoryComponentType","DOMQuery","EventEmitter"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new(b("EventEmitter"))(),h=new Map(),i=new Map(),j=new Map();function k(a){a=a;var b=[];while(a)b.unshift(a),a=a.parentElement;return b}function l(a,b){__p&&__p();if(a===null)return null;var c=k(a);a=null;var d=null;b.forEach(function(b){var e=b[0];b=b[1];e=k(e);for(var f=0;f<c.length;++f)if(c[f]!==e[f]){(d===null||f>d)&&(d=f,a=b);break}});return a}a={registerVideoPlayerController:function(a,c){var d=a.getVideoID(),e=h.get(d);e?e.push(a):(e=[a],h.set(d,e));d=null;c===b("CommercialBreakHostStoryComponentType").POP_OVER_MENU?d=this.findPopoverAsyncMenuForVideoPlayerController(a):c===b("CommercialBreakHostStoryComponentType").HOST_STORY_HEADER&&(d=this.findHostStoryControllerForVideoPlayerController(a));if(!d)return;g.emit(d.getInstanceID()+"/register",a)},registerHostStoryController:function(a,b,c){var d=j.get(b);d?d.push(a):(d=[a],j.set(b,d));this.findVideoControllerForStoryController(a,b,c)},registerPopoverAsyncMenu:function(a,b){var c=b.host_video_id;if(!c)return;a=new m(a,b);b=a.getInstanceID();var d=i.get(c);d||(d=[],i.set(c,d));d.push(a);this._informStoryComponentRegister(a.getTriggerElem(),b,c,a.registerVideoPlayerController.bind(a))},_informStoryComponentRegister:function(a,b,c,d){g.addListener(b+"/register",d);d=this.findVideoPlayerControllerForElement(a,c);if(!d)return;g.emit(b+"/register",d)},findVideoPlayerControllerForElement:function(a,b){b=h.get(b);return!b?null:l(a,b.filter(function(a){return!a.isState("destroyed")&&!a.isState("fallback")}).map(function(a){return[a.getRootNode(),a]}))},findPopoverAsyncMenuForVideoPlayerController:function(a){var b=i.get(a.getVideoID());return!b?null:l(a.getRootNode(),b.map(function(a){return[a.getTriggerElem(),a]}))},findHostStoryControllerForVideoPlayerController:function(a){var c=j.get(a.getVideoID());if(!c)return null;for(var d=0;d<c.length;d++){var e=c[d];if(b("DOMQuery").contains(e.getContainerElement(),a.getRootNode()))return e}return null},findVideoControllerForStoryController:function(a,c,d){__p&&__p();g.addListener(a.getInstanceID()+"/register",d);d=h.get(c);if(!d)return;d=d.filter(function(a){return!a.isState("destroyed")&&!a.isState("fallback")});for(var c=0;c<d.length;c++){var e=d[c];if(b("DOMQuery").contains(a.getContainerElement(),e.getRootNode())){g.emit(a.getInstanceID()+"/register",e);return}}}};var m=function(){__p&&__p();function a(a,b){this._menu=a,this._originalEndpoint=this._menu._endpoint,this._additionalData=b}var b=a.prototype;b.registerVideoPlayerController=function(a){var b=this;a.addListener("commercialBreak/updateOptionMenuURI",function(a){b._updateEndpoint(a)});a.addListener("commercialBreak/recoverOptionMenuURI",function(){return b._updateEndpoint(b._originalEndpoint)})};b._updateEndpoint=function(a){var b=this._menu;b.setMenu(b._loadingMenu);b._setFocus(b._loadingMenu);b._endpoint=a;b._fetched&&(b._fetched=!1,b.fetchMenu())};b.getInstanceID=function(){return this._menu._instanceId.toString()};b.getTriggerElem=function(){return this._menu.getTriggerElem()};b.getOptionsButtonID=function(){return this._additionalData.options_button_id||""};return a}();e.exports=a}),null);