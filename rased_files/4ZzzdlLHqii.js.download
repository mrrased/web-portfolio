if (self.CavalryLogger) { CavalryLogger.start_js(["4evB4"]); }

__d("LiveVideoBroadcastErrorCreateSubscription.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"input",type:"LiveVideoMutationErrorSubscribeData!",defaultValue:null}],b=[{kind:"LinkedField",alias:null,name:"live_video_mutation_error_subscribe",storageKey:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"LiveVideoMutationErrorSubscribeResponsePayload",plural:!1,selections:[{kind:"LinkedField",alias:null,name:"live_video_error",storageKey:null,args:null,concreteType:"LiveVideoError",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"creation_time",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"error_code",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"error_message",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"error_type",args:null,storageKey:null}]}]}];return{kind:"Request",fragment:{kind:"Fragment",name:"LiveVideoBroadcastErrorCreateSubscription",type:"Subscription",metadata:null,argumentDefinitions:a,selections:b},operation:{kind:"Operation",name:"LiveVideoBroadcastErrorCreateSubscription",argumentDefinitions:a,selections:b},params:{operationKind:"subscription",name:"LiveVideoBroadcastErrorCreateSubscription",id:"2653532621324181",text:null,metadata:{subscriptionName:"live_video_mutation_error_subscribe"}}}}();e.exports=a}),null);
__d("ReactComposerLiveBroadcastPreviewActions",["ReactComposerDispatcher","ReactComposerLiveBroadcastPreviewActionType","ReactComposerLiveBroadcastPreviewStore"],(function(a,b,c,d,e,f){__p&&__p();b("ReactComposerLiveBroadcastPreviewStore");a=function(){"use strict";__p&&__p();function a(){}var c=a.prototype;c.setBroadcastConfig=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_BROADCAST_CONFIG,config:c})};c.setContentTags=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_CONTENT_TAGS,contentTags:c})};c.setAttributionTag=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_ATTRIBUTION_TAG,attributionTag:c})};c.setHasVideoStream=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_HAS_VIDEO_STREAM,hasVideoStream:c})};c.setSelectedTab=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_SELECTED_TAB,key:c})};c.setTitle=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_TITLE,title:c})};c.setShouldBlockComments=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_SHOULD_BLOCK_COMMENTS,shouldBlockComments:c})};c.setCommentModes=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_COMMENT_MODES,commentModes:c})};c.setCopyrighted=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_COPYRIGHTED,copyrighted:c})};c.setEmbeddable=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_EMBEDDABLE,embeddable:c})};c.setDisturbing=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_DISTURBING,disturbing:c})};c.setVodDisabled=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_VOD_DISABLED,vodDisabled:c})};c.setCopyrightContentCategory=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_COPYRIGHT_CONTENT_CATEGORY,selectedCategory:c})};c.setDidClickSave=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_DID_CLICK_SAVE,didClickSave:c})};c.setCopyrightMonitoringType=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_COPYRIGHT_MONITORING_TYPE,copyrightMonitoringType:c})};c.setCopyrightRuleID=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_COPYRIGHT_RULE_ID,copyrightRuleID:c})};c.setCopyrightWhitelistedFBUsers=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_COPYRIGHT_WHITELISTED_FB_USERS,copyrightWhitelistedFBUsers:c})};c.setCopyrightWhitelistedIGUserNames=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_COPYRIGHT_WHITELISTED_IG_USERNAMES,copyrightWhitelistedIGUserNames:c})};c.setCopyrightOwnershipCountries=function(a,c,d){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_COPYRIGHT_OWNERSHIP_COUNTRIES,copyrightOwnershipCountries:c,areCopyrightCountriesIncluded:d})};c.setPostFinished=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_POST_FINISHED,postFinished:c})};c.setBroadcastType=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_BROADCAST_TYPE,ambientChecked:c})};c.setManualGoLive=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_MANUAL_GO_LIVE,isManualGoLive:c})};c.setEpisodeData=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerLiveBroadcastPreviewActionType").SET_EPISODE_DATA,episodeData:c})};return a}();e.exports=new a()}),null);
__d("LiveVideoBroadcastErrorCreateSubscription",["ChannelManager","RelayModern","RelayRuntime","LiveVideoBroadcastErrorCreateSubscription.graphql"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;b("RelayModern").graphql;var h=b("RelayModern").requestSubscription,i=b("RelayRuntime").ConnectionHandler,j=g!==void 0?g:g=b("LiveVideoBroadcastErrorCreateSubscription.graphql"),k=["LiveVideoBroadcastErrorLogs_errors","LiveVideoBroadcastHealthTray_errors"];b("ChannelManager").startChannelManager();function a(a,b,c){__p&&__p();var d={input:b},e=function(a,c){__p&&__p();var d=b.video_id;d=a.get(d);if(d==null)return;d=d.getLinkedRecord("input_streams");if(d==null)return;d=d.getLinkedRecords("nodes");if(d==null||d.length<1)return;var e=d[0];if(e==null)return;k.forEach(function(b){__p&&__p();var d;b=i.getConnection(e,b);if(b==null)return;d=(d=c.live_video_mutation_error_subscribe)==null?void 0:(d=d.live_video_error)==null?void 0:d.id;if(d==null)return;d=a.get(d);if(d==null)return;var f=parseInt(b.getValue("count"),10);b.setValue(f+1,"count");f=i.createEdge(a,b,d,"LiveVideoErrorsEdge");i.insertEdgeAfter(b,f)})};return h(a,{subscription:j,variables:d,updater:e,onCompleted:c==null?void 0:c.onCompleted,onError:c==null?void 0:c.onError,onNext:c==null?void 0:c.onNext})}e.exports={subscribe:a}}),null);
__d("LiveTraceWwwFalcoEvent",["FalcoLoggerInternal"],(function(a,b,c,d,e,f){"use strict";a=b("FalcoLoggerInternal").create("live_trace_www");e.exports=a}),null);
__d("LiveVideoLiveTraceBroadcasterLogger",["CurrentUser","LiveTraceWwwFalcoEvent","UserAgentData"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="BROADCASTER";a=function(){__p&&__p();function a(){}var c=a.prototype;c.logCreateEvent=function(a,c){c={u:b("CurrentUser").getID(),appID:c.toString()};b("UserAgentData").browserName!=null&&(c.browser=b("UserAgentData").browserName);b("UserAgentData").browserFullVersion!=null&&(c.browserVer=b("UserAgentData").browserFullVersion);this.$1("CREATE",a,0,"","INFO",c)};c.logBeginEvent=function(a,b){b={type:b};this.$1("BEGIN",a,0,"","INFO",b)};c.logEndEvent=function(a){var b={};this.$1("END",a,0,"","INFO",b)};c.logErrorEvent=function(a,b){this.$1("ERROR",a,0,"","ERROR",b)};c.$1=function(a,c,d,e,f,h){var i=Date.now();b("LiveTraceWwwFalcoEvent").log(function(){return{stream_id:c,stream_type:0,event_name:a,event_severity:f,event_creation_time:i,source:g,trace_id:d,parent_source:e,metadata:h}})};return a}();e.exports=new a()}),null);
__d("XLiveComposerPrivacySelectorController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live/broadcast/audienceSelector/",{video_id:{type:"FBID"},target_id:{type:"FBID"}})}),null);
__d("XLiveVideoBroadcastHandleScheduledLiveController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video_broadcast/handle_schedule/",{broadcast_id:{type:"FBID"},schedule_custom_profile_image_focus:{type:"StringToFloatMap"},schedule_feed_background_image_focus:{type:"StringToFloatMap"},planned_start_time:{type:"Int"},enable_manual_mode:{type:"Bool",defaultValue:!1}})}),null);
__d("LiveVideoBroadcastAPIBroadcastStore",["fbt","ActorURI","Arbiter","AsyncRequest","Bootloader","ErrorDialog","FluxMapStore","Form","GraphAPI","LiveVideoBroadcastActions","LiveVideoBroadcastAPIActions","LiveVideoBroadcastBroadcastStore","LiveVideoBroadcastConstants","LiveVideoBroadcastDispatcher","LiveVideoBroadcastErrorCreateSubscription","LiveVideoBroadcastIDStore","LiveVideoBroadcastUIStore","LiveVideoBroadcastUtils","SkywalkerManager","XLiveComposerPrivacySelectorController","XLiveVideoBroadcastHandleScheduledLiveController","immutable","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=(a=b("LiveVideoBroadcastConstants")).ACTIONS,i=a.ENCODER_TYPE,j=a.INPUT_SOURCE,k=a.STREAM_VALIDATION_STATUS,l=b("LiveVideoBroadcastErrorCreateSubscription").subscribe;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return b("immutable").Map({apiLivePreviewPlaying:!1,areCountriesIncluded:!1,copyrightWhitelistedFBUsers:[],copyrightWhitelistedIGUserNames:[],errorCount:null,is360Video:!1,is360Audio:!1,isContentProtectionEnabled:!1,isSingleFisheye:!1,singleFisheyeFOV:0,sphericalConfigSelectorValue:null,isContinuous:!1,isCopyrighted:!1,isEmbeddable:!0,isScheduledManualMode:!1,isUpdateRequestPending:!1,ownershipCountries:[],scheduleStartTime:null,shouldExpireAfterGoLive:!1,shouldShowGraphicContentWarning:!1,showEventLogDialog:!1,selectedInputStreamIndex:0,streamURLs:null,usePersistentStreamKeyByDefault:null,isRehearsal:!1,allowUnsecureRTMP:!1,streamValidationStatus:k.IN_PROGRESS,shouldShowLiveProducerUpsellNux:null})};d.reduce=function(a,c){__p&&__p();switch(c.type){case h.START_BROADCAST_SUCCESS:b("Arbiter").inform("BroadcastDialog/liveStarted",{broadcastID:this.get("apiBroadcastID")});break;case h.CLEANUP:a=this.getInitialState();this.$LiveVideoBroadcastAPIBroadcastStore3();break;case h.API_BROADCAST_CREATED:a=a.set("apiBroadcastID",c.id);a=a.set("streamURLs",c.streamURLs);a=a.set("apiVideoID",c.videoID);a=a.set("apiEmbedHTML",c.apiEmbedHTML);a=a.set("apiLivePreviewPlaying",!1);a=a.set("errorCount",0);a=a.set("attributionAppID",c.attributionAppID);a=a.set("isRehearsal",c.isRehearsal);a=a.set("allowUnsecureRTMP",c.allowUnsecureRTMP);this.$LiveVideoBroadcastAPIBroadcastStore4(c.id);this.$LiveVideoBroadcastAPIBroadcastStore5(c.videoID);this.$LiveVideoBroadcastAPIBroadcastStore6(c.actorID,c.videoID,c.targetID);break;case h.BROADCAST_ERROR_RECEIVED:a=a.set("errorCount",this.get("errorCount")+1);break;case h.API_BROADCAST_LIVE_PREVIEW_PLAYING:a=a.set("apiLivePreviewPlaying",c.livePreviewPlaying);break;case h.ADD_INPUT_STREAM:var d=b("LiveVideoBroadcastBroadcastStore").getState().toObject();d=d.actorID;d=b("LiveVideoBroadcastUtils").createInputStream(a.get("apiBroadcastID"),d);b("promiseDone")(d,function(a){b("LiveVideoBroadcastAPIActions").updateBackupInputStream(a.stream_url,a.secure_stream_url)});break;case h.FINISH_BROADCAST_REQUEST:this.$LiveVideoBroadcastAPIBroadcastStore7();break;case h.DELETE_API_REPLAY_VIDEO:this.$LiveVideoBroadcastAPIBroadcastStore8();break;case h.SET_API_BROADCAST_PRIVACY_SELECTOR:a=a.set("apiComposerPrivacySelector",c.apiComposerPrivacySelector);break;case h.SET_TARGET:case h.CLEAR_API_BROADCAST_ID:a=a.set("apiBroadcastID",null);a=a.set("apiLivePreviewPlaying",!1);a=a.set("errorCount",0);a=a.set("usePersistentStreamKeyByDefault",null);a=a.set("isContentProtectionEnabled",!1);break;case h.SET_CONTENT_PROTECTION_ENABLED:a=a.set("isContentProtectionEnabled",c.enabled);a=a.set("apiBroadcastID",null);break;case h.SET_IS_360_VIDEO:a=a.set("is360Video",c.value);a=a.set("is360Audio",!1);a=a.set("isSingleFisheye",!1);a=a.set("singleFisheyeFOV",180);a=a.set("sphericalConfigSelectorValue",null);a=a.set("apiBroadcastID",null);break;case h.SET_IS_360_AUDIO:a=a.set("is360Audio",c.value);c.value&&(a=a.set("isSingleFisheye",!1));a=a.set("apiBroadcastID",null);break;case h.SET_SCHEDULED_LIVE_DATA:c.isManualMode!=null&&(a=a.set("isScheduledManualMode",c.isManualMode));c.scheduleStartTime!=null&&(a=a.set("scheduleStartTime",c.scheduleStartTime));break;case h.SET_IS_SINGLE_FISHEYE:a=a.set("isSingleFisheye",c.value);a=a.set("singleFisheyeFOV",180);c.value&&(a=a.set("is360Audio",!1));a=a.set("apiBroadcastID",null);break;case h.SET_SINGLE_FISHEYE_FOV:a=a.set("singleFisheyeFOV",c.value);a=a.set("apiBroadcastID",null);break;case h.UPDATE_360_CONFIGURATION:a=a.set("sphericalConfigSelectorValue",c.value);c.value&&c.value.getAuxiliaryData().projection==="single_fish_eye"&&(a=a.set("singleFisheyeFOV",180),a=a.set("is360Audio",!1));a=a.set("apiBroadcastID",null);break;case h.SET_EMBEDDABLE:a=a.set("isEmbeddable",c.value);break;case h.SCHEDULED_LIVE_REQUEST:this.$LiveVideoBroadcastAPIBroadcastStore9(c.actorID,c.broadcastID,c.plannedStartTime,c.customProfileImage,c.customProfileImageFocus,c.feedBackgroundImage,c.feedBackgroundFocus,c.customAnnouncementThumbnail,c.enableManualMode,c.announcementPostMessage);break;case h.SET_SHOULD_EXPIRE_AFTER_GO_LIVE:a=a.set("shouldExpireAfterGoLive",c.value);break;case h.SET_SHOULD_SHOW_GRAPHIC_CONTENT_WARNING:a=a.set("shouldShowGraphicContentWarning",c.value);break;case h.SET_SHOW_EVENT_LOG_DIALOG:a=a.set("showEventLogDialog",c.value);break;case h.SET_CONTINUOUS:a=a.set("isContinuous",c.value);break;case h.SET_COPYRIGHTED:a=a.set("isCopyrighted",c.value);break;case h.SET_COPYRIGHT_MONITORING_TYPE:a=a.set("copyrightMonitoringType",c.value);break;case h.SET_COPYRIGHT_CONTENT_CATEGORY:a=a.set("selectedCategory",c.value);break;case h.SET_COPYRIGHT_OWNERSHIP_COUNTRIES:a=a.set("areCountriesIncluded",c.areCountriesIncluded);a=a.set("ownershipCountries",c.ownershipCountries);break;case h.SET_COPYRIGHT_RULE_ID:a=a.set("copyrightRuleID",c.value);break;case h.UPDATE_COPYRIGHT_WHITELISTED_FB_USERS:a=a.set("copyrightWhitelistedFBUsers",c.value);break;case h.UPDATE_COPYRIGHT_WHITELISTED_IG_USERNAMES:a=a.set("copyrightWhitelistedIGUserNames",c.value);break;case h.UPDATE_BACKUP_INPUT_STREAM:d=Object.assign({},a.get("streamURLs"));d.backupStreamURL=c.backupStreamURL;d.backupSecureStreamURL=c.backupSecureStreamURL;a=a.set("streamURLs",d);break;case h.API_GO_LIVE_CLICKED:a=a.set("isUpdateRequestPending",!0);break;case h.ERROR_STARTING_API_BROADCAST:a=a.set("isUpdateRequestPending",!1);break;case h.SET_IS_REHEARSAL:a=a.set("isRehearsal",c.value);a=a.set("apiBroadcastID",null);break;case h.UPDATE_UI_CONFIG:if(c.values.copyrightInformation!=null){var f;d=c.values.copyrightInformation;a=a.set("isCopyrighted",(f=d.isCopyrighted)!=null?f:!1).set("copyrightMonitoringType",(f=d.monitoringType)!=null?f:null).set("selectedCategory",(f=d.category)!=null?f:null).set("areCountriesIncluded",(f=d.areCountriesIncluded)!=null?f:!1).set("ownershipCountries",(f=d.ownershipCountries)!=null?f:[]).set("copyrightRuleID",(f=d.matchRuleID)!=null?f:null).set("copyrightWhitelistedFBUsers",(f=d.fbWhitelistedUsers)!=null?f:[]).set("copyrightWhitelistedIGUserNames",(f=d.igWhitelistedUsers)!=null?f:[])}c.values.usePersistentStreamKeyByDefault!=void 0&&(a=a.set("usePersistentStreamKeyByDefault",c.values.usePersistentStreamKeyByDefault));c.values.broadcastType!=void 0&&(a=a.set("isContinuous",c.values.broadcastType===1));c.values.shouldExpireAfterGoLive!=void 0&&(a=a.set("shouldExpireAfterGoLive",c.values.shouldExpireAfterGoLive));c.values.shouldShowGraphicContentWarning!=void 0&&(a=a.set("shouldShowGraphicContentWarning",c.values.shouldShowGraphicContentWarning));c.values.isEmbeddable!=void 0&&(a=a.set("isEmbeddable",c.values.isEmbeddable));a=a.set("shouldShowLiveProducerUpsellNux",c.values.shouldShowLiveProducerUpsellNux===!0);break;case h.SET_SELECTED_ENCODER_TYPE:if(c.encoderType===i.STREAM_KEY){d=b("LiveVideoBroadcastUIStore").getState().toObject();f=d.accessToken;b("GraphAPI")("2.8",e.id).object("live_video",a.get("apiBroadcastID")).post({access_token:f,live_encoders:[]})}break;case h.SET_SELECTED_INPUT_STREAM_INDEX:a=a.set("selectedInputStreamIndex",c.value);break;case h.SET_STREAM_VALIDATION_STATUS:a=a.set("streamValidationStatus",c.value);break;default:break}return a};d.$LiveVideoBroadcastAPIBroadcastStore4=function(a){this.$LiveVideoBroadcastAPIBroadcastStore1&&this.$LiveVideoBroadcastAPIBroadcastStore1.unsubscribe(),this.$LiveVideoBroadcastAPIBroadcastStore1=b("SkywalkerManager").subscribe("video/broadcast/error/"+a,function(){return b("LiveVideoBroadcastAPIActions").broadcastErrorReceived()})};d.$LiveVideoBroadcastAPIBroadcastStore5=function(a){var c=this;this.$LiveVideoBroadcastAPIBroadcastStore3();b("Bootloader").loadModules(["RelayFBEnvironment"],function(d){c.$LiveVideoBroadcastAPIBroadcastStore2=l(d,{video_id:a},{onError:function(){b("LiveVideoBroadcastActions").errorCreatingBroadcastErrorLogSusbscription(),c.$LiveVideoBroadcastAPIBroadcastStore2=null}})},"LiveVideoBroadcastAPIBroadcastStore")};d.$LiveVideoBroadcastAPIBroadcastStore3=function(){if(this.$LiveVideoBroadcastAPIBroadcastStore2==null)return;this.$LiveVideoBroadcastAPIBroadcastStore2.dispose();this.$LiveVideoBroadcastAPIBroadcastStore2=null};d.$LiveVideoBroadcastAPIBroadcastStore9=function(a,c,d,e,f,g,h,i,j,k){k=b("XLiveVideoBroadcastHandleScheduledLiveController").getURIBuilder().getURI();k=b("ActorURI").create(k,a);a={broadcast_id:c,enable_manual_mode:!!j,planned_start_time:d,schedule_custom_profile_image_focus:f,schedule_feed_background_image_focus:h};c=this.$LiveVideoBroadcastAPIBroadcastStore10.bind(this,j);d=b("Form").createFormData(a);e!=null&&d.append("schedule_custom_profile_image",e);i!=null&&d.append("schedule_custom_background_image",i);g!=null&&d.append("schedule_feed_background_image",g);new(b("AsyncRequest"))(k).setAllowCrossOrigin(!1).setMethod("POST").setRawData(d).setErrorHandler(this.$LiveVideoBroadcastAPIBroadcastStore11).setHandler(c).send()};d.$LiveVideoBroadcastAPIBroadcastStore10=function(a){a?(b("LiveVideoBroadcastActions").setScheduledLiveData(!0,null),b("LiveVideoBroadcastActions").scheduledLiveSuccess(!1,!0)):b("LiveVideoBroadcastActions").scheduledLiveSuccess(!0,!1)};d.$LiveVideoBroadcastAPIBroadcastStore11=function(a,c){b("LiveVideoBroadcastActions").scheduledLiveFail(c!=null?c.getResponse():null)};d.$LiveVideoBroadcastAPIBroadcastStore6=function(a,c,d){var e=b("XLiveComposerPrivacySelectorController").getURIBuilder();e=b("ActorURI").create(e.getURI(),a);new(b("AsyncRequest"))().setURI(e).setData({video_id:c,target_id:d}).setMethod("POST").send()};d.$LiveVideoBroadcastAPIBroadcastStore7=function(){var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.inputSource;if(a===j.CAMERA)return;b("Bootloader").loadModules(["ModernLiveVideoEndMutation","RelayFBEnvironment"],function(a,c){a.commit(c,{videoID:b("LiveVideoBroadcastIDStore").get("videoID")},{onCompleted:function(){b("LiveVideoBroadcastActions").finishBroadcastSuccess()},onError:function(a){b("LiveVideoBroadcastActions").errorEndBroadcastMutationFail(a),b("ErrorDialog").show(g._("End broadcast error"),g._("Error ending broadcast, please try again"))}})},"LiveVideoBroadcastAPIBroadcastStore")};d.$LiveVideoBroadcastAPIBroadcastStore8=function(){var a=this.get("apiVideoID");a&&b("LiveVideoBroadcastBroadcastStore").deleteVideo(a)};return c}(b("FluxMapStore"));c.__moduleID=e.id;e.exports=new c(b("LiveVideoBroadcastDispatcher"))}),null);
__d("XLiveVideoUpdateBroadcastController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video_broadcast/update/",{broadcast_id:{type:"FBID"},description:{type:"String"},privacyx:{type:"String"},political_district:{type:"String"},targeted_privacy_data:{type:"HackType"},title:{type:"String"},planned_start_time:{type:"Int"},is_continuous:{type:"Bool",defaultValue:!1},is_episode:{type:"Bool",defaultValue:!1},season_id:{type:"FBID"},series_id:{type:"FBID"},playlist_ids:{type:"FBIDVector"},crosspost_page_ids:{type:"FBIDVector"},breaking_news_expiration:{type:"Int"},group_join_target_id:{type:"FBID"},remove_group_join_cta:{type:"Bool",defaultValue:!1},stars_is_enabled:{type:"Bool",defaultValue:!1},is_commentating_disabled:{type:"Bool",defaultValue:!1},is_isr_enabled:{type:"Bool",defaultValue:!1},language:{type:"String"},thumbnail_uri:{type:"String"},broadcast_playback_mode:{type:"Enum",enumType:1},enable_event_ticket_promotion:{type:"Bool",defaultValue:!1},is_viewerside_clipping_enabled:{type:"Bool",defaultValue:!0}})}),null);
__d("LiveVideoBroadcastAfterBootloadUtils",["fbt","ActorURI","AsyncRequest","ComposerVideoPostUtils","ErrorDialog","LiveVideoBroadcastActions","LiveVideoBroadcastAPIActions","LiveVideoBroadcastUtils","ShareDialogAudienceTypes","VideoCopyrightAPI","XLiveVideoUpdateBroadcastController","expectationViolation","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a,c){var d="",e;d;a.audience==b("ShareDialogAudienceTypes").PAGE?(d=a.audienceTargets[0].actorId,e=a.audienceTargets[0].pageId):a.audience==b("ShareDialogAudienceTypes").OWN?(d=c||"",e=c||""):(d=a.actorId?a.actorId:"",e=a.audienceTargets[0]||d);return{actorID:d,targetID:e}}function c(){b("ErrorDialog").show(g._("Broadcast error"),g._("Error starting broadcast, please try again"))}function h(a){__p&&__p();var c={};if(a.selectedAttributionTag){var d=b("ComposerVideoPostUtils").getAttributionTagID(a.selectedAttributionTag);c=babelHelpers["extends"]({},c,{app_attribution_tag:d})}if(a.selectedGame){d=b("ComposerVideoPostUtils").getGameID(a.selectedGame);c=babelHelpers["extends"]({},c,{game_id:d})}if(a.selectedGroups){d=b("ComposerVideoPostUtils").getGroupIDs(a.selectedGroups);c=babelHelpers["extends"]({},c,{crossshare_group_ids:d})}if(a.videoTJApp){d=b("ComposerVideoPostUtils").getVideoTJAppID(a.videoTJApp);c=babelHelpers["extends"]({},c,{video_tj_app_id:d})}a.videoTitle&&(c=babelHelpers["extends"]({},c,{title:a.videoTitle}));if(a.contentTags){d=a.contentTags.map(function(a){return a.getUniqueID()});c=babelHelpers["extends"]({},c,{content_tags:d})}if(a.arena){c=babelHelpers["extends"]({},c,{arena_id:(d=a.arena)==null?void 0:d.getUniqueID()})}a.fundraiserGoal&&(c=babelHelpers["extends"]({},c,{fundraiser_goal:a.fundraiserGoal}));a.language&&(c=babelHelpers["extends"]({},c,{language:a.language}));a.thumbnailUpload&&(c=babelHelpers["extends"]({},c,{thumbnail_uri:a.thumbnailUpload.thumbURI}));return c}function d(a,c,d,e,f,g,j,k,l,m,n,o,p){var q=h(l),r=b("LiveVideoBroadcastUtils").getComposerFormData(f.contextConfig.composerID,f.config.targetData.targetID,f.config.contextInfo,p);!k?i(c,e,m,r,q,n,o):b("promiseDone")(b("VideoCopyrightAPI").copyrightVideo(a,b("nullthrows")(j),d,g,"live_video_composer"),function(a){i(c,e,m,r,q,n,o)},function(a){b("LiveVideoBroadcastAPIActions").errorStartingAPIBroadcast("copyright call",a)})}function i(a,c,d,e,f,g,h){c||b("expectationViolation")("cannot update broadcast without a broadcastiD");c=b("XLiveVideoUpdateBroadcastController").getURIBuilder().setFBID("broadcast_id",c).getURI();if(!a){b("expectationViolation")("cannot start broadcast without an actorID");return}c=b("ActorURI").create(c,a);new(b("AsyncRequest"))(c).setData(babelHelpers["extends"]({},d,e,f)).setHandler(g).setErrorHandler(function(a){h(),b("LiveVideoBroadcastActions").serverError(a)}).send()}f={getIDsFromTarget:a,showErrorDialog:c,updateBroadcastRequest:d,getUpdateMetadata:h,sendUpdateRequest:i};e.exports=f}),null);
__d("LiveVideoBroadcastCopyrightUtils",["LiveVideoBroadcastActions","SkywalkerManager"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=[];a={handleCopyrightEvent:function(a,c){c&&b("LiveVideoBroadcastActions").handleCopyrightEvent(a,c)},endLiveBroadcastWithCopyrightViolation:function(){b("LiveVideoBroadcastActions").setBroadcastEndedWithCopyrightViolation(),b("LiveVideoBroadcastActions").finishBroadcastRequest()},subscribeToCopyrightEvents:function(a){a=b("SkywalkerManager").subscribe("live/www/copyright/"+a,function(a){a=JSON.parse(a.payload);b("LiveVideoBroadcastActions").setCopyrightTriggered(!0);b("LiveVideoBroadcastActions").setCopyrightsViolationDialogState(a.event)});g.push(a)},unsubscribeTokens:function(){for(var a=0;a<g.length;a++){var b=g[a];b.unsubscribe()}}};e.exports=a}),null);
__d("XLiveVideoCheckIsPublishedController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live_video/check_is_published/",{broadcast_id:{type:"FBID",required:!0},end_if_unpublished:{type:"Bool",defaultValue:!1}})}),null);
__d("XLiveVideoCreateBroadcastController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/create_broadcast/create/",{app_id:{type:"Int",defaultValue:1761791807395020},target_id:{type:"FBID",required:!0},enable_content_protection:{type:"Bool",defaultValue:!1},is_360_broadcast:{type:"Bool",defaultValue:!1},is_360_audio_broadcast:{type:"Bool",defaultValue:!1},is_single_fisheye_broadcast:{type:"Bool",defaultValue:!1},single_fisheye_fov:{type:"Int",defaultValue:0},projection:{type:"Enum",enumType:1},stereoscopic_mode:{type:"Enum",enumType:1},is_rehearsal:{type:"Bool",defaultValue:!1},is_instagram_crosspost_enabled:{type:"Bool",defaultValue:!1}})}),null);
__d("XLiveVideoInitCommentsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live_video/init_comments/",{broadcast_id:{type:"FBID",required:!0},target_id:{type:"FBID",required:!0}})}),null);
__d("XLiveVideoPublishBroadcastController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live_video/publish/",{broadcast_id:{type:"FBID"},description:{type:"String"}})}),null);
__d("LiveVideoBroadcastBroadcastStore",["fbt","CollabRTCChromeScreenSharingExtension","Bootloader","DateConsts","ErrorDialog","LiveVideoBroadcastActions","LiveVideoBroadcastConstants","ActorURI","AsyncRequest","LiveVideoBroadcastDispatcher","FBRTCHangupReason","FluxMapStore","immutable","LiveVideoBroadcastAPIBroadcastStore","LiveVideoBroadcastAfterBootloadUtils","LiveVideoBroadcastCopyrightUtils","LiveVideoBroadcastIDStore","LiveVideoBroadcastUIStore","LiveVideoBroadcastUtils","LiveVideoLiveTraceBroadcasterLogger","MediaRecorder","RTCCallActions","RTCCallStore","RTCMWProtocolHandler","RTCUtils","UFILiveStreamingComments","ThisControllerNoLongerExists","XLiveVideoCheckIsPublishedController","XLiveVideoCreateBroadcastController","XLiveVideoInitCommentsController","XLiveVideoPublishBroadcastController","LiveStreamingSessionLogServiceProvider","LiveStreamingConfigBuilder","FalcoEventLogWriter","UserAgent","FBWWWLiveStreamingClientBuilder","FBLogger","setTimeout","gkx","qex"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();b("CollabRTCChromeScreenSharingExtension");var h=b("LiveVideoBroadcastConstants").ACTIONS,i=b("LiveVideoBroadcastConstants").BROADCAST_STATE,j=b("LiveVideoBroadcastConstants").CAMERA_DIMENSIONS,k=b("LiveVideoBroadcastConstants").CAMERA_STATE,l=b("LiveVideoBroadcastConstants").INPUT_SOURCE,m=273465416184080,n=2e3;a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$LiveVideoBroadcastBroadcastStore4=!1,b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.getInitialState=function(){return b("immutable").Map({recordedChunks:[]})};d.reduce=function(a,c){__p&&__p();switch(c.type){case h.INITIALIZE:a=this.saveProps(a,c.value);break;case h.START_BROADCAST_REQUEST:a=a.set("broadcastStartTime",Date.now());var d=this.startBroadcast();!c.blockRequest&&d&&this.sendLiveVideoPublishBroadcastRequest();break;case h.START_BROADCAST_SUCCESS:this.$LiveVideoBroadcastBroadcastStore6();this.$LiveVideoBroadcastBroadcastStore7();break;case h.REQUEST_UFI:this.$LiveVideoBroadcastBroadcastStore6();break;case h.ATTEMPT_RECONNECTION:d=this.get("maxFailureRetries")||0;var e=this.get("failureRetries")||0;this.attemptReconnection(e,d);a=a.set("failureRetries",e+1);break;case h.WEBRTC_CONNECTION_ESTABLISHED:a=a.set("failureRetries",0);break;case h.FINISH_BROADCAST_REQUEST:this.finishBroadcast();break;case h.GET_WEBCAM_STREAM_URL_REQUEST:if(this.$LiveVideoBroadcastBroadcastStore4)break;d=c.config&&c.config.audioInput?c.config.audioInput:a.get("selectedAudioInput");e=c.config&&c.config.videoInput?c.config.videoInput:a.get("selectedVideoInput");var f=a.get("mediaStream");f&&b("RTCUtils").stopMediaStream(f);a=a.set("selectedAudioInput",d);a=a.set("selectedVideoInput",e);this.createWebcamStreamUrl(d,e);break;case h.GET_SCREEN_STREAM_URL_REQUEST:f=c.config&&c.config.audioInput?c.config.audioInput:a.get("selectedAudioInput");a=a.set("selectedAudioInput",f);this.$LiveVideoBroadcastBroadcastStore8(f);break;case h.SCHEDULED_LIVE_SUCCESS:if(!c.shouldCloseDialog)break;case h.CLEANUP:a=this.getInitialState();this.$LiveVideoBroadcastBroadcastStore9();this.$LiveVideoBroadcastBroadcastStore10();break;case h.SET_INPUT_SOURCE:this.$LiveVideoBroadcastBroadcastStore7();break;case h.GET_WEBCAM_STREAM_URL_SUCCESS:a=a.set("selectedVideoInputSource","CAMERA");a=a.set("mediaStream",c.value.mediaStream);break;case h.GET_SCREEN_STREAM_URL_SUCCESS:a=a.set("selectedVideoInputSource","SCREEN");a=a.set("mediaStream",c.value.mediaStream);break;case h.DELETE_REPLAY_VIDEO:this.$LiveVideoBroadcastBroadcastStore11();break;case h.PREPARE_THUMBNAIL_URI:this.prepareThumbnailUri();break;case h.SET_THUMBNAIL_URI:a=a.set("thumbnailUri",c.value);break;case h.ERROR_TIME_OUT_WAITING_FOR_PUBLISH:case h.ERROR_TRACK_ENDED:this.finishBroadcast();break;case h.SET_TARGET:a=a.set("broadcastId",null);a=a.set("actorID",null);a=a.set("targetID",null);this.$LiveVideoBroadcastBroadcastStore12(a,c.value);break;case h.CLEAR_BROADCAST_ID:a=a.set("broadcastId",null);a=a.set("actorID",null);a=a.set("targetID",null);break;case h.SET_BROADCAST_ID:a=a.set("broadcastId",c.value);break;case h.SET_VIDEO_ID:a=a.set("videoId",c.value);break;case h.SET_CONTENT_PROTECTION_ENABLED:case h.SET_IS_360_VIDEO:case h.SET_IS_360_AUDIO:case h.SET_IS_SINGLE_FISHEYE:case h.SET_SINGLE_FISHEYE_FOV:case h.UPDATE_360_CONFIGURATION:case h.SET_IS_REHEARSAL:this.$LiveVideoBroadcastBroadcastStore13();break;case h.UPDATE_UI_CONFIG:c.values.broadcastId&&(a.get("broadcastId")==null&&c.values.broadcastId!=null&&b("LiveVideoLiveTraceBroadcasterLogger").logCreateEvent(c.values.broadcastId,m),a=a.set("broadcastId",c.values.broadcastId));c.values.videoId&&(a=a.set("videoId",c.values.videoId));c.values.viewerID&&(a=a.set("viewerID",c.values.viewerID));c.values.feedbackID&&(a=a.set("feedbackID",c.values.feedbackID));c.values.targetID&&(a=a.set("targetID",c.values.targetID));c.values.actorID&&(a=a.set("actorID",c.values.actorID));c.values.formData&&(a=a.set("formData",c.values.formData));c.values.streamSettings&&(a=a.set("streamSettings",c.values.streamSettings));c.values.maxFailureRetries&&(a=a.set("maxFailureRetries",c.values.maxFailureRetries));c.values.retryTimeoutSeconds&&(a=a.set("retryTimeoutSeconds",c.values.retryTimeoutSeconds));c.values.speedTestConfig&&(a=a.set("speedTestConfig",c.values.speedTestConfig));c.values.webRTCLoggingFreq&&(a=a.set("webRTCLoggingFreq",c.values.webRTCLoggingFreq));c.values.gks&&(a=a.set("vp8",c.values.gks.live_www_broadcasting_vp8_encoding));c.values.accountID&&(a=a.set("accountID",c.values.accountID));c.values.isCrosspost&&(a=a.set("isCrosspost",c.values.isCrosspost));c.values.scheduledLiveCrosspostPayload&&(a=a.set("scheduledLiveCrosspostPayload",c.values.scheduledLiveCrosspostPayload));c.values.dashIngestUri&&(a=a.set("dashIngestUri",c.values.dashIngestUri));c.values.speedTestUri&&(a=a.set("speedTestUri",c.values.speedTestUri));break;default:break}return a};d.saveProps=function(a,b){return a.set("failureRetries",0).set("vp8",b.vp8).set("formData",b.formData)};d.$LiveVideoBroadcastBroadcastStore13=function(){b("LiveVideoBroadcastDispatcher").waitFor([b("LiveVideoBroadcastAPIBroadcastStore").getDispatchToken()]);var a=this.get("actorID"),c=this.get("targetID");a&&c&&this.$LiveVideoBroadcastBroadcastStore14(a,c)};d.$LiveVideoBroadcastBroadcastStore14=function(a,c){__p&&__p();var d=this;this.$LiveVideoBroadcastBroadcastStore2&&this.$LiveVideoBroadcastBroadcastStore2.abandon();var e=b("LiveVideoBroadcastAPIBroadcastStore").getState().toObject(),f=e.is360Audio,g=e.is360Video,h=e.isContentProtectionEnabled,i=e.isSingleFisheye,j=e.singleFisheyeFOV,k=e.sphericalConfigSelectorValue,l=e.isRehearsal;e="equirectangular";var n="mono";k&&(e=k.getAuxiliaryData().projection,n=k.getAuxiliaryData().stereoMode);k=b("XLiveVideoCreateBroadcastController").getURIBuilder().setInt("app_id",m).setFBID("target_id",String(c)).setBool("enable_content_protection",h).setBool("is_360_broadcast",g).setBool("is_rehearsal",l);g&&(k=k.setBool("is_360_audio_broadcast",f).setBool("is_single_fisheye_broadcast",i).setInt("single_fisheye_fov",j).setEnum("projection",e).setEnum("stereoscopic_mode",n));k=k.getURI();k=b("ActorURI").create(k,a);this.$LiveVideoBroadcastBroadcastStore2=new(b("AsyncRequest"))(k).setData({video_broadcast_infra_type:"RTMP"}).setHandler(function(e){d.$LiveVideoBroadcastBroadcastStore2=null,b("LiveVideoBroadcastActions").apiBroadcastCreated(a||"",e.payload.id,{primaryStreamURL:e.payload.stream_url,primarySecureStreamURL:e.payload.secure_stream_url,backupStreamURL:e.payload.backup_stream_url,backupSecureStreamURL:e.payload.backup_secure_stream_url},e.payload.video_id,c||"",e.payload.embed_html,"",l===!0,e.payload.allow_unsecure_rtmp)}).setMethod("POST");this.$LiveVideoBroadcastBroadcastStore2.send()};d.$LiveVideoBroadcastBroadcastStore12=function(a,c){__p&&__p();var d=this;c=b("LiveVideoBroadcastAfterBootloadUtils").getIDsFromTarget(c,a.get("accountID"));var e=c.actorID,f=c.targetID;a=a.set("actorID",e);a=a.set("targetID",f);c=3e4;this.$LiveVideoBroadcastBroadcastStore1&&this.$LiveVideoBroadcastBroadcastStore1.abandon();var g=b("XLiveVideoCreateBroadcastController").getURIBuilder().setFBID("target_id",f).getURI();g=b("ActorURI").create(g,e);this.$LiveVideoBroadcastBroadcastStore1=new(b("AsyncRequest"))(g).setHandler(function(a){d.$LiveVideoBroadcastBroadcastStore1=null;var c=b("LiveVideoBroadcastUIStore").get("composerConfig");if(!c){b("LiveVideoBroadcastUtils").handleCreateBroadcastError({error:"No broadcast config"});return}var g=b("LiveVideoBroadcastUtils").getComposerFormData(c.contextConfig.composerID,f,c.config.contextInfo);b("LiveVideoBroadcastUtils").fetchUIConfig(e,f,a.payload.id,c.contextConfig.composerType,g)}).setErrorHandler(b("LiveVideoBroadcastUtils").handleCreateBroadcastError).setMethod("POST").setTimeoutHandler(c,b("LiveVideoBroadcastUtils").handleCreateBroadcastError);this.$LiveVideoBroadcastBroadcastStore1.send();this.$LiveVideoBroadcastBroadcastStore14(e,f);return a};d.$LiveVideoBroadcastBroadcastStore15=function(a){__p&&__p();var c=a.getAudioTracks();if(c.length===0){b("RTCUtils").stopMediaStream(a);b("LiveVideoBroadcastActions").updateCameraState(k.MICROPHONE_NOT_FOUND);return!1}if(c[0].readyState==="ended"){b("setTimeout")(function(){return b("LiveVideoBroadcastActions").readyStateEnded()},0);return!1}c=a.getVideoTracks();if(c.length===0){b("RTCUtils").stopMediaStream(a);b("LiveVideoBroadcastActions").updateCameraState(k.CAMERA_NOT_FOUND);return!1}if(c[0].readyState==="ended"){b("setTimeout")(function(){return b("LiveVideoBroadcastActions").readyStateEnded()},0);return!1}return!0};d.$LiveVideoBroadcastBroadcastStore8=function(a){__p&&__p();var c=this,d=function(a){__p&&__p();if(!c.$LiveVideoBroadcastBroadcastStore15(a))return;b("RTCCallActions").removeAllLocalStreams(!0);b("RTCCallActions").removeAllLocalScreenStreams(!0);b("RTCCallActions").addLocalScreenStream(a);b("LiveVideoBroadcastActions").getScreenStreamUrlSuccess({mediaStream:a});b("LiveVideoBroadcastActions").updateCameraState(k.BROADCAST);a=a.getVideoTracks();a[0].addEventListener("ended",function(){var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.broadcastState;a===i.LIVE?c.finishBroadcast():b("LiveVideoBroadcastActions").getWebcamStreamUrlRequest()});c.$LiveVideoBroadcastBroadcastStore3=a[0].getSettings().height};a=this.$LiveVideoBroadcastBroadcastStore16(a);var e={audio:a,video:!1},f=b("RTCCallStore").getState().localUser.getScreenStream();if(f)return b("RTCUtils").getUserMedia(e).then(function(a){__p&&__p();for(var b=f.getAudioTracks(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;f.removeTrack(e)}f.addTrack(a.getAudioTracks()[0]);return f})["catch"](function(a){b("LiveVideoBroadcastActions").errorMediaValidation(a,!0)});a={audio:!1,video:{frameRate:{ideal:5,max:15},height:{exact:1080},mediaSource:"screen",width:{max:1920}}};var g=this.$LiveVideoBroadcastBroadcastStore17();g&&(a={audio:!1,video:{frameRate:{ideal:30,max:30},height:{min:480,ideal:720,max:1080},mediaSource:"screen",width:{min:640,ideal:1280,max:1920}}});return b("RTCUtils").getUserScreenMedia(a,"live_broadcast").then(function(a){return b("RTCUtils").getUserMedia(e).then(function(b){a.addTrack(b.getAudioTracks()[0]);return a})}).then(d)["catch"](function(a){b("LiveVideoBroadcastActions").errorMediaValidation(a,!0)})};d.createWebcamStreamUrl=function(a,c){__p&&__p();var d=this;this.$LiveVideoBroadcastBroadcastStore4=!0;var e={width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080},aspectRatio:{ideal:j.SIXTEEN_NINE},frameRate:{ideal:30,max:30}};a=this.$LiveVideoBroadcastBroadcastStore16(a);var f=this.$LiveVideoBroadcastBroadcastStore17(),g=this.get("streamSettings");f&&!(g==null?void 0:g.isLiveCommentating)?b("qex")._("1290807")?e={frameRate:30,height:720,aspectRatio:j.SIXTEEN_NINE}:e={frameRate:{ideal:30,max:30},width:{min:320,ideal:1280,max:1280},height:{min:240,ideal:720,max:720},aspectRatio:{ideal:j.SIXTEEN_NINE}}:g&&g.simpleConstaints?e={height:{ideal:368},aspectRatio:{ideal:j.SIXTEEN_NINE}}:!f&&g&&g.firefoxSimpleConstraints?e={height:720,aspectRatio:j.SIXTEEN_NINE}:(g==null?void 0:g.isLiveCommentating)&&(e={width:{min:480,ideal:720,max:1080},height:{min:480,ideal:720,max:1080},aspectRatio:{ideal:j.ONE_ONE}});c&&(e=babelHelpers["extends"]({},e,{deviceId:c}));f={audio:a,video:e};g=function(a){__p&&__p();d.$LiveVideoBroadcastBroadcastStore4=!1;var c=b("LiveVideoBroadcastUIStore").get("shouldBeClosed");if(c){b("RTCUtils").stopMediaStream(a);return}if(!d.$LiveVideoBroadcastBroadcastStore15(a))return;b("RTCCallActions").removeAllLocalStreams(!0);b("RTCCallActions").removeAllLocalScreenStreams(!0);b("RTCCallActions").addLocalStream(a);b("LiveVideoBroadcastActions").getWebcamStreamUrlSuccess({mediaStream:a});b("LiveVideoBroadcastActions").updateCameraState(k.BROADCAST);c=a.getVideoTracks();c[0].addEventListener("ended",function(){var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.broadcastState;a===i.LIVE&&b("LiveVideoBroadcastActions").errorTrackEnded()});d.$LiveVideoBroadcastBroadcastStore3=c[0].getSettings().height};return this.$LiveVideoBroadcastBroadcastStore18(f).then(g)["catch"](function(a){d.$LiveVideoBroadcastBroadcastStore4=!1;b("LiveVideoBroadcastActions").errorMediaValidation(a,!0);var c=a.name==="NotAllowedError"||a.name==="PermissionDismissedError";c=c?k.CAMERA_NOT_ALLOWED:k.CAMERA_NOT_FOUND;b("LiveVideoBroadcastActions").updateCameraState(c,a)})};d.$LiveVideoBroadcastBroadcastStore16=function(a){var b={echoCancellation:!1,channelCount:2,deviceId:a},c=this.$LiveVideoBroadcastBroadcastStore17(),d=this.get("streamSettings");!c&&d&&d.simpleConstaints&&(b={deviceId:a});return b};d.$LiveVideoBroadcastBroadcastStore18=function(a){return b("RTCUtils").getUserMedia(a)};d.$LiveVideoBroadcastBroadcastStore19=function(a){var b=this.get("recordedChunks");b&&a&&a.data.size>0&&b.push(a.data)};d.$LiveVideoBroadcastBroadcastStore9=function(){var a=this.get("mediaStream");a&&b("RTCUtils").stopMediaStream(a)};d.$LiveVideoBroadcastBroadcastStore10=function(){var a=this.get("videoId");if(!a)return;b("UFILiveStreamingComments").stop(a)};d.$LiveVideoBroadcastBroadcastStore17=function(){return!!b("qex")._("1241427")||b("gkx")("944030")};d.startBroadcast=function(){var a=this.get("streamSettings");if(!(a==null?void 0:a.isLiveCommentating)&&this.$LiveVideoBroadcastBroadcastStore17())return this.$LiveVideoBroadcastBroadcastStore20();else return this.$LiveVideoBroadcastBroadcastStore21()};d.$LiveVideoBroadcastBroadcastStore20=function(){__p&&__p();var a=this.get("broadcastId");if(a==null){this.$LiveVideoBroadcastBroadcastStore22("Missing broadcastID");return!1}var c=this.get("dashIngestUri");if(c==null){this.$LiveVideoBroadcastBroadcastStore22("Missing dashIngestUri");return!1}var d=this.get("speedTestUri");if(d==null){this.$LiveVideoBroadcastBroadcastStore22("Missing speedTestUri");return!1}var e=this.get("mediaStream");if(e==null){this.$LiveVideoBroadcastBroadcastStore22("Missing mediaStream");return!1}if(!this.$LiveVideoBroadcastBroadcastStore15(e)){this.$LiveVideoBroadcastBroadcastStore22("MediaStream is invalid");return!1}c=new(b("LiveStreamingConfigBuilder"))(a).populateFromQE().setDashIngestUrl(c).setSpeedTestUrl(d).build();d="";var f="";e.getVideoTracks().length>0&&(d=e.getVideoTracks()[0].label);e.getVideoTracks().length>0&&(f=e.getAudioTracks()[0].label);d={videoTrackName:d,audioTrackName:f};f=new(b("FalcoEventLogWriter"))();d=new(b("LiveStreamingSessionLogServiceProvider"))(JSON.stringify(d));this.$LiveVideoBroadcastBroadcastStore5=new(b("FBWWWLiveStreamingClientBuilder"))(c).setSessionCallbacks({onStarted:function(){b("LiveVideoLiveTraceBroadcasterLogger").logBeginEvent(a,"dash")},onStopped:this.$LiveVideoBroadcastBroadcastStore23.bind(this),onError:function(c){b("LiveVideoLiveTraceBroadcasterLogger").logErrorEvent(a,{e:c.description,what:c.what,code:c.code}),b("FBLogger")("www_livestreaming").warn(c.toString()),b("LiveVideoBroadcastActions").errorWWWSDKClientError()}}).setMediaStream(e).addService(f).addServiceProvider(d).build();this.$LiveVideoBroadcastBroadcastStore5.start();return!0};d.$LiveVideoBroadcastBroadcastStore21=function(){__p&&__p();var a=this,c=this.get("broadcastId");if(c==null){this.$LiveVideoBroadcastBroadcastStore22("Missing broadcastID");return!1}var d=this.get("mediaStream");if(d==null){this.$LiveVideoBroadcastBroadcastStore22("Missing mediaStream");return!1}if(!this.$LiveVideoBroadcastBroadcastStore15(d)){this.$LiveVideoBroadcastBroadcastStore22("MediaStream is invalid");return!1}b("LiveVideoLiveTraceBroadcasterLogger").logBeginEvent(c,"rtc");d=this.get("streamSettings");var e=this.get("vp8")?{video:"VP8/90000"}:{video:"H264/90000"};b("RTCCallActions").addListener("onIceConnectionStateChange",function(a){a==="disconnected"?b("LiveVideoBroadcastActions").errorConnectionBroken():a==="connected"?b("LiveVideoBroadcastActions").webRTCConnectionEstablished():b("LiveVideoBroadcastActions").iceConnectionStateChanged(a),a==="failed"&&b("LiveVideoBroadcastActions").attemptReconnection()});var f={};d&&(f={"H264/90000":{"x-google-start-bitrate":d.initialBitrate},"opus/48000/2":{minaveragebitrate:d.minAudioBitrate,maxaveragebitrate:d.maxAudioBitrate},"VP8/90000":d.maxVideoBitrate?{"x-google-max-bitrate":d.maxVideoBitrate}:{}});var g=b("RTCCallStore").getState();g=g.localUser;g=[].concat(g.streams.toArray(),g.screenStreams.toArray());var h=void 0;d&&d.firefoxSimpleConstraints&&(h=function(b){var c=a.$LiveVideoBroadcastBroadcastStore3?a.$LiveVideoBroadcastBroadcastStore3/360:1;b.setParameters(babelHelpers["extends"]({},b.getParameters(),{encodings:[{maxBitrate:1e6,scaleResolutionDownBy:c}]}))});d=new(b("RTCMWProtocolHandler"))(null,!0);d.startCall([],g,"LIVE:"+c,{addStreamCallback:h,callTrigger:"live_video",formatParameters:f,preferredCodecs:e});b("LiveVideoBroadcastCopyrightUtils").subscribeToCopyrightEvents(c);d=Math.max(b("LiveVideoBroadcastConstants").PUBLISH_FAILURE_TIMEOUT_S-5,0);b("setTimeout")(function(){return a.$LiveVideoBroadcastBroadcastStore24()},d*b("DateConsts").MS_PER_SEC);return!0};d.$LiveVideoBroadcastBroadcastStore22=function(a){b("setTimeout")(function(){return b("LiveVideoBroadcastActions").errorBroadcastCouldNotStart(a)},0)};d.sendLiveVideoPublishBroadcastRequest=function(){__p&&__p();var a=this.get("broadcastId");a=b("XLiveVideoPublishBroadcastController").getURIBuilder().setFBID("broadcast_id",a);a=b("ActorURI").create(a.getURI(),this.get("actorID"));var c=this.get("formData"),d=b("LiveVideoBroadcastUIStore").getState().toObject();d=d.composerConfig;if(d){d=b("LiveVideoBroadcastUtils").getComposerFormData(d.contextConfig.composerID,d.contextConfig.targetID,d.config.contextInfo);for(var e in c)d[e]!==null&&(c[e]=d[e])}new(b("AsyncRequest"))().setURI(a).setData(c).setHandler(function(){return b("LiveVideoBroadcastActions").startLiveBroadcastSuccess()}).setErrorHandler(function(a){return b("LiveVideoBroadcastActions").errorBroadcastCouldNotStart((a=a.getErrorDescriptionString())!=null?a:"Error starting broadcast")}).send()};d.attemptReconnection=function(a,c){__p&&__p();var d=b("LiveVideoBroadcastUIStore").getState().toObject(),e=d.connectionBroken;d=d.broadcastState;if(a<c&&d===i.LIVE&&e){a=this.get("broadcastId");if(a!=null){c=new(b("RTCMWProtocolHandler"))();c.iceRestart("LIVE:"+a,b("RTCCallStore").getState().callInfo.serverInfoData)}b("setTimeout")(function(){return b("LiveVideoBroadcastActions").attemptReconnection()},(this.get("retryTimeoutSeconds")||b("LiveVideoBroadcastConstants").DEFAULT_RETRY_TIMEOUT_SECONDS)*1e3)}else e&&b("setTimeout")(function(){return b("LiveVideoBroadcastActions").errorConnectionFailed()},1)};d.$LiveVideoBroadcastBroadcastStore24=function(a){__p&&__p();var c=this,d=this.get("broadcastId")||"";a=a?b("LiveVideoBroadcastConstants").PUBLISH_FAILURE_TIMEOUT_S*1.5:b("LiveVideoBroadcastConstants").PUBLISH_FAILURE_TIMEOUT_S;var e=this.getCurrentBroadcastTime()>a;a=b("XLiveVideoCheckIsPublishedController").getURIBuilder().setFBID("broadcast_id",d).setBool("end_if_unpublished",e).getURI();var f=function(a,d){var f=b("LiveVideoBroadcastUIStore").getState().toObject();f=f.broadcastState;if(f===i.FINISHED)return;f=a.payload;f.is_published||(e?b("LiveVideoBroadcastActions").errorTimeOutWaitingForPublish("CLIENT"):b("setTimeout")(function(){c.$LiveVideoBroadcastBroadcastStore24(d)},n))};new(b("AsyncRequest"))().setURI(a).setHandler(function(a){return f(a,!1)}).setErrorHandler(function(a){return f(a,!0)}).send()};d.$LiveVideoBroadcastBroadcastStore6=function(){__p&&__p();var a=b("LiveVideoBroadcastIDStore").get("broadcastID"),c=this.get("targetID");if(!a||!c){b("setTimeout")(function(){return b("LiveVideoBroadcastActions").requestUFI()},n);return}a=b("XLiveVideoInitCommentsController").getURIBuilder().setFBID("broadcast_id",a).setFBID("target_id",c);c=b("ActorURI").create(a.getURI(),this.get("actorID"));a=function(a){a=a.payload;if(!a.success){b("setTimeout")(function(){return b("LiveVideoBroadcastActions").requestUFI()},n);return}b("LiveVideoBroadcastActions").updateBroadcastUIConfig({feedbackID:a.feedbackID})};new(b("AsyncRequest"))().setURI(c).setHandler(a).setErrorHandler(a).send()};d.$LiveVideoBroadcastBroadcastStore7=function(){var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.inputSource;a!==l.CAMERA&&this.$LiveVideoBroadcastBroadcastStore9()};d.$LiveVideoBroadcastBroadcastStore23=function(){var a=this.get("broadcastId");a!=null&&b("LiveVideoLiveTraceBroadcasterLogger").logEndEvent(a);var c=this.get("videoId");b("Bootloader").loadModules(["ModernLiveVideoEndMutation","RelayFBEnvironment"],function(a,d){var e=this;a.commit(d,{videoID:c},{onCompleted:function(){b("LiveVideoBroadcastActions").finishBroadcastSuccess()},onError:function(a){b("LiveVideoBroadcastActions").errorEndBroadcastMutationFail(a),e.$LiveVideoBroadcastBroadcastStore25()}})},"LiveVideoBroadcastBroadcastStore")};d.finishBroadcast=function(){__p&&__p();var a=b("LiveVideoBroadcastUIStore").getState().toObject();a=a.inputSource;if(a!==l.CAMERA)return;var c=this.get("broadcastId"),d=this.get("videoId");if(c==null||d==null){this.$LiveVideoBroadcastBroadcastStore25();b("setTimeout")(function(){return b("LiveVideoBroadcastActions").errorEndBroadcastMutationFail("No broadcast ID")},0);return}this.$LiveVideoBroadcastBroadcastStore17()&&this.$LiveVideoBroadcastBroadcastStore5?this.$LiveVideoBroadcastBroadcastStore5.stop():(b("setTimeout")(function(){return b("RTCCallActions").removeAllLocalStreams(!0)},0),b("setTimeout")(function(){b("RTCMWProtocolHandler").endCall("LIVE:"+c,b("RTCCallStore").getState().callInfo.serverInfoData,b("FBRTCHangupReason").HANGUP_CALL,"User ending live stream"),b("Bootloader").loadModules(["ModernLiveVideoEndMutation","RelayFBEnvironment"],function(a,c){var e=this;a.commit(c,{videoID:d},{onCompleted:function(){b("LiveVideoBroadcastActions").finishBroadcastSuccess()},onError:function(a){b("LiveVideoBroadcastActions").errorEndBroadcastMutationFail(a),e.$LiveVideoBroadcastBroadcastStore25()}})},"LiveVideoBroadcastBroadcastStore")},1e3*3));a=this.get("recorder");var e=this.get("recordedChunks");if(a&&e){a.stop();a=new Blob(e,{type:"video/webm"});e=URL.createObjectURL(a);a=document.createElement("a");document.body&&(document.body.appendChild(a),a.style.cssText="display: none",a.href=e,a.download="test.webm",a.click(),window.URL.revokeObjectURL(e))}};d.$LiveVideoBroadcastBroadcastStore11=function(){var a=this.get("videoId");a&&this.deleteVideo(a)};d.deleteVideo=function(a){new(b("AsyncRequest"))().setURI("/ajax/video/actions/delete/").setData({fbid:a,redirect:!1}).setHandler(function(a){}).send()};d.prepareThumbnailUri=function(){var a=b("ThisControllerNoLongerExists").__DEADURI__("5g1c01ti");new(b("AsyncRequest"))().setURI(a).setMethod("POST").setHandler(function(a){return b("LiveVideoBroadcastActions").setThumbnailUri(a.getPayload())}).send()};d.getCurrentBroadcastTime=function(){var a=this.get("broadcastStartTime");return typeof a==="number"?Math.floor((Date.now()-a)/1e3):0};d.$LiveVideoBroadcastBroadcastStore25=function(){b("ErrorDialog").show(g._("End broadcast error"),g._("Error ending broadcast, please try again"))};return c}(b("FluxMapStore"));a.__moduleID=e.id;e.exports=new a(b("LiveVideoBroadcastDispatcher"))}),null);
__d("LiveVideoBroadcastIDStore",["FluxDerivedStore","LiveVideoBroadcastAPIBroadcastStore","LiveVideoBroadcastBroadcastStore","LiveVideoBroadcastDispatcher","LiveVideoBroadcastUIStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.__getStores=function(){return[b("LiveVideoBroadcastAPIBroadcastStore"),b("LiveVideoBroadcastBroadcastStore"),b("LiveVideoBroadcastUIStore")]};d.__getData=function(a){a=b("LiveVideoBroadcastUIStore").get("inputSource");var c=b("LiveVideoBroadcastAPIBroadcastStore").getState().toObject(),d=c.apiBroadcastID;c=c.apiVideoID;var e=b("LiveVideoBroadcastBroadcastStore").getState().toObject();return{inputSource:a,apiBroadcastID:d,apiVideoID:c,cameraBroadcastID:e.broadcastId,cameraVideoID:e.videoId}};d.__computeResult=function(a,b){if(b.inputSource==="CAMERA"||b.inputSource==="EDIT")switch(a){case"broadcastID":return b.cameraBroadcastID;case"videoID":return b.cameraVideoID}if(b.inputSource==="API"||b.inputSource==="VIDEO_GAME"||b.inputSource==="EDIT_SCHEDULE")switch(a){case"broadcastID":return b.apiBroadcastID;case"videoID":return b.apiVideoID}return null};return c}(b("FluxDerivedStore"));a.__moduleID=e.id;e.exports=new a(b("LiveVideoBroadcastDispatcher"))}),null);
__d("ComposerVideoShowsState",["immutable"],(function(a,b,c,d,e,f){"use strict";a={composerID:null,isEpisode:null,isRecap:!1,shouldShowPlaylistSelector:!1,playlistIDs:[],seasonID:null,seriesID:null,playlistOptions:{},seasonOptions:{},seriesOptionsMap:b("immutable").Map(),seriesToSeasonOptionsMap:b("immutable").Map()};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record(a));e.exports=c}),null);
__d("ComposerVideoShowsStore",["AsyncRequest","AsyncTypedRequest","ComposerVideoShowsActions","ComposerVideoShowsActionTypes","ComposerVideoShowsDispatcher","ComposerVideoShowsState","ComposerVideoUploadActions","FluxReduceStore","LiveVideoBroadcastActions","PageContentTabShowsStore","ReactComposerLiveBroadcastPreviewActions","XPagesVideoListsController","XVideoComposerBootloadEditDistributionTabController","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return new(b("ComposerVideoShowsState"))()};d.initialize=function(a,c,d){__p&&__p();this.getState().composerID===a&&d?(d=this.getState(),d=d.set("shouldShowPlaylistSelector",!0)):(d=this.getInitialState(),d=d.set("composerID",a),d=d.set("shouldShowPlaylistSelector",!1));c==="page_content_tab_season_details"&&(d=d.set("isEpisode",!0),d=d.set("seasonID",b("PageContentTabShowsStore").getVideoListID()||null));if(c==="page_content_tab_playlist_details"){a=b("PageContentTabShowsStore").getVideoListID();d=d.set("playlistIDs",a?[a]:[]);d=d.set("shouldShowPlaylistSelector",!0)}(c==="shows_home_episodes_card"||c==="page_composer_episode_card")&&(d=d.set("isEpisode",!0));c==="live_broadcast"&&(d=d.set("shouldShowPlaylistSelector",!0));return d};d.reduce=function(a,c){__p&&__p();switch(c.type){case b("ComposerVideoShowsActionTypes").INITIALIZE:a=this.initialize(c.composerID,c.composerEntryPoint,c.isEditing);this.$ComposerVideoShowsStore1(a);break;case b("ComposerVideoShowsActionTypes").SET_IS_EPISODE:a=a.set("isEpisode",c.isEpisode);c.isEpisode||(a=a.set("seriesID",null),a=a.set("seasonID",null));this.$ComposerVideoShowsStore1(a);break;case b("ComposerVideoShowsActionTypes").SET_PLAYLISTS:a=a.set("playlistIDs",c.playlistIDs);this.$ComposerVideoShowsStore1(a);break;case b("ComposerVideoShowsActionTypes").SET_SEASON:a=a.set("seasonID",c.seasonID);this.$ComposerVideoShowsStore1(a);break;case b("ComposerVideoShowsActionTypes").SET_SERIES:a=a.set("seriesID",c.seriesID);this.$ComposerVideoShowsStore1(a);break;case b("ComposerVideoShowsActionTypes").SET_SERIES_AND_SEASON_OPTIONS:a=a.set("seriesToSeasonOptionsMap",c.seriesToSeasonOptionsMap);a=a.set("seriesOptionsMap",c.seriesOptionsMap);return a;case b("ComposerVideoShowsActionTypes").LOAD_EPISODE_DATA:a=this.initialize(c.composerID,"",!0);a=a.set("isEpisode",c.isEpisode);a=a.set("seasonID",c.seasonID);a=a.set("seriesID",c.seriesID);a=a.set("playlistIDs",c.playlistIDs);this.$ComposerVideoShowsStore1(a);break;case b("ComposerVideoShowsActionTypes").SET_PLAYLIST_OPTIONS:return a.set("playlistOptions",c.value);case b("ComposerVideoShowsActionTypes").SET_SEASON_OPTIONS:return a.set("seasonOptions",c.value);case b("ComposerVideoShowsActionTypes").REQUEST_VIDEO_LIST_OPTIONS:this.$ComposerVideoShowsStore2(c.pageID);break;case b("ComposerVideoShowsActionTypes").REQUEST_SHOWS_V2_VIDEO_DATA:this.$ComposerVideoShowsStore3(c.videoID);break}return a};d.$ComposerVideoShowsStore1=function(a){b("ComposerVideoUploadActions").updateEpisodeData(a.get("composerID"),{isEpisode:a.get("isEpisode"),seasonID:a.get("seasonID"),seriesID:a.get("seriesID"),playlistIDs:a.get("playlistIDs"),isRecap:a.get("isRecap")}),b("ReactComposerLiveBroadcastPreviewActions").setEpisodeData(a.get("composerID"),{isEpisode:a.get("isEpisode"),seasonID:a.get("seasonID"),seriesID:a.get("seriesID"),playlistIDs:a.get("playlistIDs"),isRecap:!1}),b("LiveVideoBroadcastActions").setEpisodeData({isEpisode:a.get("isEpisode"),seasonID:a.get("seasonID"),seriesID:a.get("seriesID"),playlistIDs:a.get("playlistIDs"),isRecap:!1})};d.$ComposerVideoShowsStore2=function(a){a=b("XPagesVideoListsController").getURIBuilder().setFBID("page_id",a).getURI();new(b("AsyncTypedRequest"))(a).setReplaceTransportMarkers().setPayloadHandler(function(a){var c=a.seasonOptions||{},d=a.playlistOptions||{},e=a.seriesOptionsMap||b("immutable").Map();a=a.seriesToSeasonOptionsMap||b("immutable").Map();b("ComposerVideoShowsActions").setSeriesAndSeasonOptions(e,a);b("ComposerVideoShowsActions").setSeasonOptions(c);b("ComposerVideoShowsActions").setPlaylistOptions(d)}).send()};d.$ComposerVideoShowsStore3=function(a){a=b("XVideoComposerBootloadEditDistributionTabController").getURIBuilder().setFBID("video_id",a).getURI();new(b("AsyncRequest"))(a).setHandler(function(a){if(a.payload.showsV2EpisodeData!=null){a=a.payload.showsV2EpisodeData;a.season_id!=null&&b("ComposerVideoShowsActions").setSeason(String(a.season_id));b("ComposerVideoShowsActions").setSeries(String(a.show_id))}}).setErrorHandler(function(a){}).send()};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("ComposerVideoShowsDispatcher"))}),null);
__d("XLiveVideoBroadcastMaybeLaunchEndScreenSurveyController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/live/broadcast/end_screen_survey/",{broadcast_id:{type:"FBID",required:!0}})}),null);
__d("LiveVideoBroadcastUIStore",["fbt","AsyncRequest","ComposerVideoShowsActions","ComposerVideoShowsDispatcher","ComposerVideoShowsStore","ErrorDialog","FluxMapStore","LiveVideoBroadcastAfterBootloadUtils","LiveVideoBroadcastBroadcastStore","LiveVideoBroadcastConstants","LiveVideoBroadcastDispatcher","ReactComposerActions","ReactComposerAttachmentActions","ReactComposerAttachmentType","ReactComposerFundraiserAttachmentActions","ReactComposerLoggingName","ReactComposerTaggerActions","ReactComposerTaggerType","ReactDOM","VideoBroadcastFlowTypes","XLiveVideoBroadcastMaybeLaunchEndScreenSurveyController","ge","gkx","immutable","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("VideoBroadcastFlowTypes").BroadcastPlaybackMode,i=(a=b("LiveVideoBroadcastConstants")).ACTIONS,j=a.BROADCAST_STATE,k=a.CAMERA_STATE,l=a.INPUT_SOURCE,m=a.ENCODER_TYPE,n=a.RHC_TAB_TYPE;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return b("immutable").Map({broadcastCouldNotStart:!1,broadcastCouldNotPublish:!1,broadcastState:j.PREVIEW,cameraState:k.CHECK_CAMERA_ACCESS,canSeeCopyrightOption:!1,canSeeDisturbingOptions:!1,countdownTime:null,connectionBroken:!1,connectionFailed:!1,dialog:null,dialogContainerID:null,composerConfig:null,isCommentatingDisabled:!1,isIsrEnabled:!1,broadcastPlaybackMode:h.NORMAL_LATENCY,isOnline:!0,isUpdateRequestPending:!1,showNUX:!1,showReplay:!1,startTime:0,wasEverOffline:!1,ufiConfig:{},ufiMarkup:null,isDescriptionExpanded:!1,warnOnExit:!0,tagList:null,pendingCleanup:!1,peopleTaggerSource:null,inputSource:l.CAMERA,isScheduledLiveRequestPending:!1,showSaveChangesDialog:!1,showJoinGroupCTA:!1,sponsorEnabled:!1,sponsorConfig:null,isDialogLoading:!1,hideInputToggle:!1,shouldBeClosed:!0,canEndLiveVideo:!1,canEnableLiveCoverVideo:!1,isLiveCoverVideoEnabled:!1,selectedEncoderType:m.STREAM_KEY,selectedRHCTab:n.POST,isRewindEnabled:!1,canEnableRewind:!1,commentModes:[],isFundraiserSelected:!1,enableWasLivePollVoting:!1,canSeeWasLiveVotingToggle:!1,hasCreatedPollRecently:!1,videoPollWWWPlacement:"top_right",rightsManagerVersion:null,enableEventTicketPromotion:!1,showArenaTypeahead:!1,showStarsTagger:!1,isViewerSideClippingEnabled:!0,canEnableViewerSideClipping:!1})};d.reduce=function(a,c){__p&&__p();switch(c.type){case i.SHOW_REPLAY:a=a.set("showReplay",!0);break;case i.SET_UPDATE_REQUEST_PENDING:a=a.set("isUpdateRequestPending",c.value);break;case i.UPDATE_CAMERA_STATE:a=a.set("cameraState",c.value);break;case i.UPDATE_COUNTDOWN:a=a.set("countdownTime",c.value);break;case i.FINISH_COUNT_DOWN:a=a.set("startTime",Date.now());a=a.set("broadcastState",j.READY_TO_LIVE);a=a.set("countdownTime",null);break;case i.API_GO_LIVE_CLICKED:a=a.set("startTime",Date.now());break;case i.START_BROADCAST_SUCCESS:a=a.set("broadcastState",j.LIVE);a=a.set("countdownTime",null);a=this.$LiveVideoBroadcastUIStore1(a);break;case i.START_LIVE_COUNTDOWN:a=a.set("countdownTime",b("LiveVideoBroadcastConstants").COUNTDOWN_START_TIME);break;case i.CANCEL_LIVE_COUNTDOWN:a=a.set("countdownTime",null);break;case i.FINISH_BROADCAST_REQUEST:a=a.set("broadcastState",j.FINISHING);break;case i.FINISH_BROADCAST_SUCCESS:a=a.set("broadcastState",j.FINISHED);a=a.set("showReplay",!0);var d=b("LiveVideoBroadcastBroadcastStore").get("broadcastId");d=b("XLiveVideoBroadcastMaybeLaunchEndScreenSurveyController").getURIBuilder().setFBID("broadcast_id",d).getURI();new(b("AsyncRequest"))().setURI(d).setMethod("GET").setReadOnly(!0).send();break;case i.API_BROADCAST_STOPPED:a=a.set("broadcastState",j.FINISHED);a=a.set("showReplay",!0);break;case i.ERROR_CONNECTION_BROKEN:a=a.set("connectionBroken",!0);break;case i.ERROR_CONNECTION_FAILED:a=a.set("connectionFailed",!0);break;case i.WEBRTC_CONNECTION_ESTABLISHED:a=a.set("connectionBroken",!1);break;case i.ERROR_BROADCAST_COULD_NOT_START:a=a.set("broadcastCouldNotStart",!0);break;case i.ERROR_BROADCAST_PUBLISH_FAIL:case i.ERROR_TIME_OUT_WAITING_FOR_PUBLISH:case i.ERROR_MWS_BAD_AUDIO_OR_VIDEO_DATA:case i.ERROR_RTC_CLIENT_ERROR:case i.ERROR_WWWSDK_CLIENT_ERROR:case i.ERROR_TRACK_ENDED:a=a.set("broadcastCouldNotPublish",!0);a=a.set("broadcastState",j.FINISHED);break;case i.ACCEPT_ERROR_BROADCAST_COULD_NOT_START:a=a.set("broadcastCouldNotStart",!1);break;case i.ERROR_STARTING_API_BROADCAST:b("LiveVideoBroadcastAfterBootloadUtils").showErrorDialog();break;case i.NETWORK_OFFLINE:a=a.set("isOnline",!1);a=a.set("wasEverOffline",!0);break;case i.NETWORK_ONLINE:a=a.set("isOnline",!0);break;case i.SET_SHOW_NUX:a=a.set("showNUX",c.value);break;case i.SETUP_UFI:a.get("broadcastState")===j.LIVE&&(a=a.set("ufiConfig",c.ufiConfig),a=a.set("ufiMarkup",c.ufiMarkup));break;case i.SET_DIALOG:a=a.set("dialog",c.value);break;case i.SET_DIALOG_CONTAINER_ID:a=a.set("dialogContainerID",c.value);break;case i.SET_COMPOSER_CONFIG:a=a.set("composerConfig",c.value);break;case i.SET_DESCRIPTION_EXPANDED:a=a.set("isDescriptionExpanded",c.value);break;case i.INITIALIZE:a=a.set("shouldBeClosed",!1);c.value&&c.value.inputSource!=null&&(a=a.set("inputSource",c.value.inputSource));break;case i.CLEANUP:a=this.getInitialState();a=a.set("warnOnExit",!1);a=a.set("pendingCleanup",!0);a=this.$LiveVideoBroadcastUIStore2(a);break;case i.FINISHED_CLEANUP:a=a.set("pendingCleanup",!1);break;case i.SCHEDULED_LIVE_SUCCESS:c.shouldCloseDialog?(a=this.getInitialState(),a=a.set("warnOnExit",!1),a=this.$LiveVideoBroadcastUIStore2(a,!0)):a=a.set("isScheduledLiveRequestPending",!1);break;case i.PREPARE_BROADCAST_FOR_SCHEDULED_LIVE:case i.SCHEDULED_LIVE_REQUEST:a=a.set("isScheduledLiveRequestPending",!0);break;case i.SCHEDULED_LIVE_FAIL:a=a.set("isScheduledLiveRequestPending",!1);this.$LiveVideoBroadcastUIStore3();break;case i.SET_DESCRIPTION:a=a.set("description",c.value.description);a=a.set("shortDescription",c.value.shortDescription);break;case i.SET_TAG_LIST:a=a.set("tagList",c.value);break;case i.SET_PRIVACY_SELECTOR:a=a.set("privacySelector",c.value);break;case i.SET_PEOPLE_TAGGER_SOURCE:a=a.set("peopleTaggerSource",c.value);break;case i.SET_IS_FUNDRAISER_SELECTED:a=a.set("isFundraiserSelected",c.value);break;case i.SET_TARGET:case i.CLEAR_BROADCAST_ID:a=a.set("allowBroadcastRehearsal",!1);a=a.set("composerPrivacySelector",null);a=a.set("profilePicUri",null);a=a.set("sponsorEnabled",!1);a=a.set("targetingEnabled",!1);a=a.set("canEnableRewind",!1);a=a.set("isRewindEnabled",!1);a=a.set("canEnableViewerSideClipping",!1);a=a.set("isViewerSideClippingEnabled",!0);a=a.set("showJoinGroupCTA",!1);a=a.set("showStarsTagger",!1);a=this.$LiveVideoBroadcastUIStore4(a,!1);break;case i.UPDATE_UI_CONFIG:c.values.encoders&&(a=a.set("encoders",c.values.encoders));c.values.composerPrivacySelector&&(a=a.set("composerPrivacySelector",c.values.composerPrivacySelector));c.values.shareMode&&(a=a.set("shareMode",c.values.shareMode));c.values.description&&(a=a.set("description",c.values.description));c.values.shortDescription&&(a=a.set("shortDescription",c.values.shortDescription));c.values.showNUX&&(a=a.set("showNUX",c.values.showNUX));c.values.tagList&&(a=a.set("tagList",c.values.tagList));a=a.set("hasCreatedPollRecently",c.values.hasCreatedPollRecently===!0);c.values.privacySelector&&(a=a.set("privacySelector",c.values.privacySelector));c.values.profileLink&&(a=a.set("profileLink",c.values.profileLink));if(c.values.gks){a=a.set("gks",c.values.gks);d=((d=c.values.gks)==null?void 0:d.live_rewind_option_in_composer)===!0;a=a.set("canEnableRewind",d);d&&c.values.isRewindEnabled!=void 0&&(a=a.set("isRewindEnabled",c.values.isRewindEnabled));d=((d=c.values.gks)==null?void 0:d.can_enable_viewerside_clipping)===!0;a=a.set("canEnableViewerSideClipping",d);d&&c.values.isViewerSideClippingEnabled!=void 0&&(a=a.set("isViewerSideClippingEnabled",c.values.isViewerSideClippingEnabled));d=((d=c.values.gks)==null?void 0:d.allow_broadcast_rehearsal)===!0;a=a.set("allowBroadcastRehearsal",d)}c.values.commentModes&&(a=a.set("commentModes",c.values.commentModes));c.values.targetSelectorProps&&(a=a.set("targetSelectorProps",c.values.targetSelectorProps));c.values.profilePicUri&&(a=a.set("profilePicUri",c.values.profilePicUri));c.values.accessToken&&(a=a.set("accessToken",c.values.accessToken));c.values.timezoneString&&(a=a.set("timezoneString",c.values.timezoneString));c.values.cameraEmbedHTML!==void 0&&(a=a.set("cameraEmbedHTML",c.values.cameraEmbedHTML));c.values.targetingEnabled!==void 0&&(a=a.set("targetingEnabled",c.values.targetingEnabled));c.values.fundraiserEnabled!==void 0&&(a=this.$LiveVideoBroadcastUIStore4(a,Boolean(c.values.fundraiserEnabled)));c.values.canSeeDisturbingOptions!==void 0&&(a=a.set("canSeeDisturbingOptions",c.values.canSeeDisturbingOptions));c.values.sponsorEnabled!==void 0&&(a=a.set("sponsorEnabled",c.values.sponsorEnabled));c.values.sponsorConfig&&(a=a.set("sponsorConfig",c.values.sponsorConfig));c.values.showJoinGroupCTA!==void 0&&(a=a.set("showJoinGroupCTA",c.values.showJoinGroupCTA));c.values.showStarsTagger!==void 0&&(a=a.set("showStarsTagger",c.values.showStarsTagger));c.values.canSeeCopyrightOption!==void 0&&(a=a.set("canSeeCopyrightOption",c.values.canSeeCopyrightOption));c.values.rightsManagerVersion!==void 0&&(a=a.set("rightsManagerVersion",c.values.rightsManagerVersion));if(c.values.targetID&&c.values.targetID!==b("LiveVideoBroadcastBroadcastStore").get("targetID")){if(c.values.isShowPage){b("ComposerVideoShowsDispatcher").explicitlyRegisterStore(b("ComposerVideoShowsStore"));d=this.get("composerConfig");var e=d&&d.composerID;e&&b("setTimeout")(function(){return b("ComposerVideoShowsActions").initialize(e,"live_broadcast",!1)},0)}a=a.set("episodeData",null)}if(c.values.episodeData!=void 0){var f=c.values.episodeData;a=a.set("episodeData",f);b("ComposerVideoShowsDispatcher").explicitlyRegisterStore(b("ComposerVideoShowsStore"));d=this.get("composerConfig");var g=d&&d.composerID;g&&b("setTimeout")(function(){b("ComposerVideoShowsActions").initialize(g,"live_broadcast",!0),b("ComposerVideoShowsActions").loadEpisodeData(g,f)},0)}c.values.isShowPage!==void 0&&(a=a.set("isShowPage",c.values.isShowPage));c.values.canEndLiveVideo!=void 0&&(a=a.set("canEndLiveVideo",c.values.canEndLiveVideo));d=c.values.pageLiveCoverVideoData;d&&(a=a.set("isLiveCoverVideoEnabled",d.isLiveCoverVideoEnabled),a=a.set("canEnableLiveCoverVideo",d.canEnableLiveCoverVideo));c.values.hasGamingContext&&(a=a.set("hasGamingContext",c.values.hasGamingContext),a.get("inputSource")===l.API&&(a=a.set("inputSource",l.VIDEO_GAME)));c.values.showArenaTypeahead&&(a=a.set("showArenaTypeahead",c.values.showArenaTypeahead));c.values.enableEventTicketPromotion!=null&&(a=a.set("enableEventTicketPromotion",c.values.enableEventTicketPromotion));break;case i.SET_INPUT_SOURCE:a=a.set("inputSource",c.source);break;case i.SET_DIALOG_LOADING:a=a.set("isDialogLoading",c.value);break;case i.SET_EPISODE_DATA:a=a.set("episodeData",c.episodeData);break;case i.SET_HIDE_INPUT_TOGGLE:a=a.set("hideInputToggle",c.hideInputToggle);break;case i.SET_BROADCAST_STATE:a=a.set("broadcastState",c.broadcastState);break;case i.SET_START_TIME:a=a.set("startTime",c.startTime);break;case i.SET_LIVE_COVER_VIDEO_ENABLED:a=a.set("isLiveCoverVideoEnabled",c.value);break;case i.SET_SELECTED_ENCODER_TYPE:a=a.set("selectedEncoderType",c.encoderType);c.encoderType===m.PAIRED_ENCODER&&(a=a.set("selectedRHCTab",n.SETTINGS));break;case i.SET_SELECTED_RHC_TAB:a=a.set("selectedRHCTab",c.selectedTab);break;case i.SET_REWIND_ENABLED:a=a.set("isRewindEnabled",c.enabled);break;case i.SET_VIEWERSIDE_CLIPPING_ENABLED:a=a.set("isViewerSideClippingEnabled",c.enabled);break;case i.SET_SHOW_SAVE_CHANGES_DIALOG:a=a.set("showSaveChangesDialog",c.value);break;case i.SET_COMMENT_MODES:a=a.set("commentModes",c.value);break;case i.ENABLE_WAS_LIVE_POLL_VOTING:a=a.set("enableWasLivePollVoting",c.enabled);break;case i.SET_SHOW_WAS_LIVE_VOTING_TOGGLE:a=a.set("canSeeWasLiveVotingToggle",c.shouldShow);break;case i.CHANGE_VIDEO_POLL_WWW_PLACEMENT:a=a.set("videoPollWWWPlacement",c.placement);break;case i.SET_COMMENTATING_DISABLED:a=a.set("isCommentatingDisabled",c.value);break;case i.SET_ISR_ENABLED:a=a.set("isIsrEnabled",c.value);break;case i.SET_BROADCAST_PLAYBACK_MODE:a=a.set("broadcastPlaybackMode",c.value);break;case i.SET_ENABLE_EVENT_TICKET_PROMOTION:a=a.set("enableEventTicketPromotion",c.value);break;case i.HIDE_WARNING_ON_EXIT:a=a.set("warnOnExit",!1);break;default:break}return a};d.$LiveVideoBroadcastUIStore3=function(){b("ErrorDialog").show(g._("Broadcast error"),g._("Error scheduling broadcast, please try again"))};d.$LiveVideoBroadcastUIStore5=function(){var a=this.get("composerConfig");a=a&&a.composerID;a&&(b("ReactComposerTaggerActions").setTaggerData(a,b("ReactComposerLoggingName").FUNDRAISER_SPROUT,b("ReactComposerTaggerType").FUNDRAISER,{}),b("ReactComposerFundraiserAttachmentActions").setMarkup(a,null))};d.$LiveVideoBroadcastUIStore4=function(a,b){a=a.set("fundraiserEnabled",b);b||this.$LiveVideoBroadcastUIStore5();return a};d.$LiveVideoBroadcastUIStore2=function(a,c){__p&&__p();var d=this.get("dialog");if(d){var e=b("ge")(this.get("dialogContainerID"));e&&b("ReactDOM").unmountComponentAtNode(e);d.destroy();a=a.set("pendingCleanup",!1)}else window.close();e=this.get("composerConfig");d=this.get("broadcastState");e=e&&e.composerID;e&&(c||d!==j.PREVIEW&&d!==j.READY_TO_LIVE?b("ReactComposerActions").reset(e):b("ReactComposerAttachmentActions").selectAttachment(e,b("ReactComposerAttachmentType").STATUS));return a};d.$LiveVideoBroadcastUIStore1=function(a){if(b("gkx")("1176856")){var c=this.get("composerConfig");c=c&&c.composerID;c&&b("ReactComposerActions").postSucceeded(c)}return a};return c}(b("FluxMapStore"));c.__moduleID=e.id;e.exports=new c(b("LiveVideoBroadcastDispatcher"))}),null);